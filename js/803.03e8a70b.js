"use strict";(self["webpackChunkcaffeineshop"]=self["webpackChunkcaffeineshop"]||[]).push([[803],{1716:function(e,t,l){l.d(t,{A:function(){return L}});var a=l(6768),o=l(4232);const s={class:"modal fade",id:"delModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},i={class:"modal-dialog",role:"document"},d={class:"modal-content border-0"},n={class:"modal-header bg-danger text-white"},r={class:"modal-title"},c={class:"modal-body"},u={class:"text-danger"},p={class:"modal-footer"};function m(e,t,l,m,h,k){return(0,a.uX)(),(0,a.CE)("div",s,[(0,a.Lk)("div",i,[(0,a.Lk)("div",d,[(0,a.Lk)("div",n,[(0,a.Lk)("h5",r,[(0,a.Lk)("span",null,"刪除 "+(0,o.v_)(l.item.title),1)]),t[1]||(t[1]=(0,a.Lk)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),(0,a.Lk)("div",c,[t[2]||(t[2]=(0,a.eW)("是否刪除",-1)),(0,a.Lk)("strong",u,(0,o.v_)(l.item.title),1),t[3]||(t[3]=(0,a.eW)(" (刪除後將無法恢復)。 ",-1))]),(0,a.Lk)("div",p,[t[4]||(t[4]=(0,a.Lk)("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"},"取消 ",-1)),(0,a.Lk)("button",{type:"button",class:"btn btn-danger",onClick:t[0]||(t[0]=t=>e.$emit("del-item",h.tempProduct))},"確認刪除")])])])],512)}var h=l(3286),k={name:"DelModal",props:{item:{type:Object,default(){return{}}}},data(){return{tempProduct:{}}},watch:{item(){this.tempProduct=this.item}},mixins:[h.A]},b=l(1241);const g=(0,b.A)(k,[["render",m]]);var L=g},2803:function(e,t,l){l.r(t),l.d(t,{default:function(){return ie}});var a=l(6768),o=l(5130),s=l(4232);const i={class:"text-end"},d={class:"table mt-4"},n={"data-item":"產品名稱"},r={"data-item":"分類"},c={"data-item":"原價"},u={"data-item":"售價"},p={"data-item":"上架狀態"},m={key:0,class:"text-success"},h={key:1,class:"text-muted"},k={"data-item":"編輯"},b={class:"btn-group"},g=["onClick"],L=["onClick"];function f(e,t,l,f,v,P){const y=(0,a.g2)("loading-modal"),x=(0,a.g2)("product-modal"),C=(0,a.g2)("del-modal"),U=(0,a.g2)("pagination-modal");return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.bF)(y,{active:v.isLoading},null,8,["active"]),t[3]||(t[3]=(0,a.Lk)("h1",null,"商品管理",-1)),(0,a.Lk)("div",i,[(0,a.Lk)("button",{class:"btn btn-brown",type:"button",onClick:t[0]||(t[0]=(0,o.D$)(e=>P.openModal(!0),["prevent"]))},[...t[1]||(t[1]=[(0,a.Lk)("i",{class:"bi bi-plus-square"},null,-1),(0,a.eW)(" 新增商品",-1)])])]),(0,a.Lk)("div",null,[(0,a.Lk)("table",d,[t[2]||(t[2]=(0,a.Lk)("thead",null,[(0,a.Lk)("tr",null,[(0,a.Lk)("th",null,"分類"),(0,a.Lk)("th",null,"產品名稱"),(0,a.Lk)("th",null,"原價"),(0,a.Lk)("th",null,"售價"),(0,a.Lk)("th",null,"上架狀態"),(0,a.Lk)("th",null,"編輯")])],-1)),(0,a.Lk)("tbody",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(v.products,e=>((0,a.uX)(),(0,a.CE)("tr",{key:e.id},[(0,a.Lk)("td",n,(0,s.v_)(e.title),1),(0,a.Lk)("td",r,(0,s.v_)(e.category),1),(0,a.Lk)("td",c,(0,s.v_)(e.origin_price),1),(0,a.Lk)("td",u,(0,s.v_)(e.price),1),(0,a.Lk)("td",p,[e.is_enabled?((0,a.uX)(),(0,a.CE)("span",m,"已上架")):((0,a.uX)(),(0,a.CE)("span",h,"未上架"))]),(0,a.Lk)("td",k,[(0,a.Lk)("div",b,[(0,a.Lk)("button",{type:"button",class:"btn btn-outline-primary btn-sm edit",onClick:t=>P.openModal(!1,e)},null,8,g),(0,a.Lk)("button",{type:"button",class:"btn btn-outline-danger btn-sm del",onClick:t=>P.openDelMdodal(e)},null,8,L)])])]))),128))])])]),(0,a.bF)(x,{ref:"productModal",product:v.tempProduct,onUpdateProduct:P.updateProduct},null,8,["product","onUpdateProduct"]),(0,a.bF)(C,{ref:"delModal",item:v.tempProduct,onDelItem:P.delProduct},null,8,["item","onDelItem"]),(0,a.bF)(U,{pages:v.pagination,onEmitPage:P.getProducts},null,8,["pages","onEmitPage"])],64)}const v={class:"modal fade",id:"exampleModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},P={class:"modal-dialog modal-lg",role:"document"},y={class:"modal-content border-0"},x={class:"modal-body"},C={class:"row"},U={class:"col-sm-4"},M={class:"mb-3"},$={class:"mb-3"},_=["src"],w={class:"mb-3"},E=["disabled"],F={class:"mb-3"},X=["disabled"],I={class:"d-flex flex-wrap flex-row bd-highlight",style:{"max-height":"140px","overflow-y":"auto"}},D=["onClick"],A=["src"],V={class:"col-sm-8"},J={class:"mb-3"},K={class:"row gx-2"},W={class:"mb-3 col-md-6"},j=["value"],N={class:"mb-3 col-md-6"},O={class:"row gx-2"},q={class:"mb-3 col-md-6"},H={class:"mb-3 col-md-6"},T={class:"mb-3"},z={class:"mb-3"},B={class:"mb-3"},G={class:"form-check"},Q={class:"modal-footer"};function R(e,t,l,i,d,n){return(0,a.uX)(),(0,a.CE)("div",v,[(0,a.Lk)("div",P,[(0,a.Lk)("div",y,[t[31]||(t[31]=(0,a.Lk)("div",{class:"modal-header bg-brown text-white"},[(0,a.Lk)("h5",{class:"modal-title",id:"exampleModalLabel"},[(0,a.Lk)("span",null,"新增商品")]),(0,a.Lk)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),(0,a.Lk)("div",x,[(0,a.Lk)("div",C,[(0,a.Lk)("div",U,[(0,a.Lk)("div",M,[t[15]||(t[15]=(0,a.Lk)("label",{for:"image",class:"form-label"},"請輸入圖片網址",-1)),(0,a.bo)((0,a.Lk)("input",{type:"text",class:"form-control",id:"image",placeholder:"請輸入圖片連結",onChange:t[0]||(t[0]=e=>n.inputFile("imageUrl")),"onUpdate:modelValue":t[1]||(t[1]=e=>d.imageUrl=e)},null,544),[[o.Jo,d.imageUrl]])]),(0,a.Lk)("div",$,[t[16]||(t[16]=(0,a.Lk)("label",{for:"customFile",class:"form-label"},[(0,a.eW)("或 上傳圖片"),(0,a.Lk)("i",{class:"fas fa-spinner fa-spin"})],-1)),(0,a.Lk)("input",{type:"file",id:"customFile",class:"form-control",ref:"fileInput",onChange:t[2]||(t[2]=e=>n.uploadFile("fileInput"))},null,544)]),(0,a.Lk)("img",{class:"img-fluid",alt:"",src:d.tempProduct.imageUrl},null,8,_),t[19]||(t[19]=(0,a.Lk)("hr",null,null,-1)),(0,a.Lk)("div",w,[t[17]||(t[17]=(0,a.Lk)("label",{for:"image",class:"form-label"},"請輸入圖片網址",-1)),(0,a.bo)((0,a.Lk)("input",{type:"text",class:"form-control",id:"image",placeholder:"請輸入圖片連結",onChange:t[3]||(t[3]=e=>n.inputFile("imagesUrl")),"onUpdate:modelValue":t[4]||(t[4]=e=>d.imagesUrl=e),disabled:(d.tempProduct.imagesUrl||[]).length>=4},null,40,E),[[o.Jo,d.imagesUrl]])]),(0,a.Lk)("div",F,[t[18]||(t[18]=(0,a.Lk)("label",{for:"customFile",class:"form-label"},[(0,a.eW)("或 上傳圖片"),(0,a.Lk)("i",{class:"fas fa-spinner fa-spin"})],-1)),(0,a.Lk)("input",{type:"file",id:"customFile",class:"form-control",ref:"filesInput",onChange:t[5]||(t[5]=e=>n.uploadFile("filesInput")),disabled:(d.tempProduct.imagesUrl||[]).length>=4},null,40,X)]),(0,a.Lk)("div",I,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(d.tempProduct.imagesUrl,(e,t)=>((0,a.uX)(),(0,a.CE)("div",{class:"flex-img",key:t},[(0,a.Lk)("i",{class:"bi bi-x-circle-fill img-del",onClick:(0,o.D$)(e=>n.imageDel(t),["prevent"])},null,8,D),(0,a.Lk)("img",{class:"img-fluid",src:d.tempProduct.imagesUrl[t],alt:""},null,8,A)]))),128))])]),(0,a.Lk)("div",V,[(0,a.Lk)("div",J,[t[20]||(t[20]=(0,a.Lk)("label",{for:"title",class:"form-label"},"標題",-1)),(0,a.bo)((0,a.Lk)("input",{type:"text",class:"form-control",id:"title",placeholder:"請輸入標題","onUpdate:modelValue":t[6]||(t[6]=e=>d.tempProduct.title=e)},null,512),[[o.Jo,d.tempProduct.title]])]),(0,a.Lk)("div",K,[(0,a.Lk)("div",W,[t[22]||(t[22]=(0,a.Lk)("label",{for:"category",class:"form-label"},"分類",-1)),(0,a.bo)((0,a.Lk)("select",{class:"form-select","aria-label":"Default select example",name:"",id:"","onUpdate:modelValue":t[7]||(t[7]=e=>d.tempProduct.category=e)},[t[21]||(t[21]=(0,a.Lk)("option",{value:"",selected:"",disabled:""},"請選擇分類",-1)),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(d.productList,e=>((0,a.uX)(),(0,a.CE)("option",{value:e,key:e},(0,s.v_)(e),9,j))),128))],512),[[o.u1,d.tempProduct.category]])]),(0,a.Lk)("div",N,[t[23]||(t[23]=(0,a.Lk)("label",{for:"price",class:"form-label"},"單位",-1)),(0,a.bo)((0,a.Lk)("input",{type:"text",class:"form-control",id:"unit",placeholder:"請輸入單位","onUpdate:modelValue":t[8]||(t[8]=e=>d.tempProduct.unit=e)},null,512),[[o.Jo,d.tempProduct.unit]])])]),(0,a.Lk)("div",O,[(0,a.Lk)("div",q,[t[24]||(t[24]=(0,a.Lk)("label",{for:"origin_price",class:"form-label"},"原價",-1)),(0,a.bo)((0,a.Lk)("input",{type:"number",class:"form-control",id:"origin_price",placeholder:"請輸入原價","onUpdate:modelValue":t[9]||(t[9]=e=>d.tempProduct.origin_price=e)},null,512),[[o.Jo,d.tempProduct.origin_price]])]),(0,a.Lk)("div",H,[t[25]||(t[25]=(0,a.Lk)("label",{for:"price",class:"form-label"},"售價",-1)),(0,a.bo)((0,a.Lk)("input",{type:"number",class:"form-control",id:"price",placeholder:"請輸入售價","onUpdate:modelValue":t[10]||(t[10]=e=>d.tempProduct.price=e)},null,512),[[o.Jo,d.tempProduct.price]])])]),t[29]||(t[29]=(0,a.Lk)("hr",null,null,-1)),(0,a.Lk)("div",T,[t[26]||(t[26]=(0,a.Lk)("label",{for:"description",class:"form-label"},"產品描述",-1)),(0,a.bo)((0,a.Lk)("textarea",{type:"text",class:"form-control",id:"description",placeholder:"請輸入產品描述","onUpdate:modelValue":t[11]||(t[11]=e=>d.tempProduct.description=e)},null,512),[[o.Jo,d.tempProduct.description]])]),(0,a.Lk)("div",z,[t[27]||(t[27]=(0,a.Lk)("label",{for:"content",class:"form-label"},"說明內容",-1)),(0,a.bo)((0,a.Lk)("textarea",{type:"text",class:"form-control",id:"content",placeholder:"請輸入產品說明內容","onUpdate:modelValue":t[12]||(t[12]=e=>d.tempProduct.content=e)},null,512),[[o.Jo,d.tempProduct.content]])]),(0,a.Lk)("div",B,[(0,a.Lk)("div",G,[(0,a.bo)((0,a.Lk)("input",{class:"form-check-input",type:"checkbox","true-value":1,"false-value":0,id:"is_enabled","onUpdate:modelValue":t[13]||(t[13]=e=>d.tempProduct.is_enabled=e)},null,512),[[o.lH,d.tempProduct.is_enabled]]),t[28]||(t[28]=(0,a.Lk)("label",{class:"form-check-label",for:"is_enabled"},"是否上架",-1))])])])])]),(0,a.Lk)("div",Q,[t[30]||(t[30]=(0,a.Lk)("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"},"取消",-1)),(0,a.Lk)("button",{type:"button",class:"btn btn-primary",onClick:t[14]||(t[14]=t=>e.$emit("update-product",d.tempProduct))},"確認")])])])],512)}l(4114);var S=l(3286),Y={name:"ProductModal",data(){return{modal:{},productList:["咖啡豆","掛耳咖啡包","罐裝茶","茶包","咖啡生活用品","茶生活用品","禮盒專區","甜點","其他"],tempProduct:{},imageUrl:"",imagesUrl:[]}},props:{product:{type:Object,default(){return{}}}},watch:{product(){this.tempProduct=this.product}},methods:{uploadFile(e){const t=this.$refs[e].files[0],l=new FormData;l.append("file-to-upload",t);const a="https://vue3-course-api.hexschool.io/api/caffeineshop/admin/upload";this.$http.post(a,l).then(t=>{t.data.success&&("fileInput"===e?this.tempProduct.imageUrl=t.data.imageUrl:this.tempProduct.imagesUrl.push(t.data.imageUrl),this.$refs[e].value="")})},inputFile(e){"imageUrl"===e?this.tempProduct[e]=this[e]:this.tempProduct[e].push(this[e]),this[e]=""},imageDel(e){this.tempProduct.imagesUrl.splice(e,1)}},mixins:[S.A]},Z=l(1241);const ee=(0,Z.A)(Y,[["render",R]]);var te=ee,le=l(1716),ae=l(8589),oe={data(){return{products:[],pagination:{},isLoading:!1,tempProduct:{},isNew:!1}},components:{ProductModal:te,DelModal:le.A,PaginationModal:ae.A},inject:["emitter"],methods:{getProducts(e=1){const t=`https://vue3-course-api.hexschool.io/api/caffeineshop/admin/products/?page=${e}`;this.isLoading=!0,this.$http.get(t).then(e=>{this.isLoading=!1,e.data.success&&(this.products=e.data.products,this.pagination=e.data.pagination,console.log(this.pagination))}).catch(e=>{this.$InformMessage(e,"取得頁面資訊")})},openModal(e,t){e?(this.tempProduct={},this.tempProduct.category="",this.tempProduct.imagesUrl=[]):(this.tempProduct={...t},this.tempProduct.imagesUrl||(this.tempProduct.imagesUrl=[])),this.isNew=e,this.$refs.productModal.showModal()},updateProduct(e){console.log(e),this.tempProduct=e;let t="https://vue3-course-api.hexschool.io/api/caffeineshop/admin/product",l="post";this.isNew||(t=`${t}/${e.id}`,l="put"),this.$http[l](t,{data:this.tempProduct}).then(e=>{e.data.success?("post"===l?this.$InformMessage(e,"商品新增"):this.$InformMessage(e,"商品更新"),this.getProducts(this.pagination.current_page)):console.log(e.data),this.$refs.productModal.hideModal()}).catch(e=>{this.$InformMessage(e,"商品更新")})},openDelMdodal(e){this.tempProduct={...e},this.$refs.delModal.showModal()},delProduct(e){this.tempProduct=e;const t=`https://vue3-course-api.hexschool.io/api/caffeineshop/admin/product/${e.id}`;this.$http.delete(t,{data:this.tempProduct}).then(t=>{this.$InformMessage(t,`商品${e.title}刪除`),this.getProducts()}).catch(e=>{this.$InformMessage(e,"商品刪除")}),this.$refs.delModal.hideModal()}},created(){this.getProducts()}};const se=(0,Z.A)(oe,[["render",f]]);var ie=se},8589:function(e,t,l){l.d(t,{A:function(){return v}});var a=l(6768),o=l(5130),s=l(4232);const i={class:"container"},d={class:"row"},n={class:"col-12"},r={"aria-label":"Page navigation example"},c={class:"pagination justify-content-center"},u={key:0,class:"page-item"},p={key:1,class:"page-item disabled"},m=["onClick"],h={key:2,class:"page-item"},k={key:3,class:"page-item disabled"};function b(e,t,l,b,g,L){return(0,a.uX)(),(0,a.CE)("div",i,[(0,a.Lk)("div",d,[(0,a.Lk)("div",n,[(0,a.Lk)("nav",r,[(0,a.Lk)("ul",c,[l.pages.has_pre?((0,a.uX)(),(0,a.CE)("li",u,[(0,a.Lk)("a",{class:"page-link",href:"#","aria-label":"Previous",onClick:t[0]||(t[0]=(0,o.D$)(e=>L.updatePage(l.pages.current_page-1),["prevent"]))},[...t[2]||(t[2]=[(0,a.Lk)("span",{"aria-hidden":"true"},"«",-1)])])])):((0,a.uX)(),(0,a.CE)("li",p,[...t[3]||(t[3]=[(0,a.Lk)("span",{class:"page-link","aria-hidden":"true"},"«",-1)])])),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(l.pages.total_pages,e=>((0,a.uX)(),(0,a.CE)("li",{class:(0,s.C4)(["page-item",{active:e===l.pages.current_page}]),key:e},[(0,a.Lk)("a",{class:"page-link",href:"#",onClick:(0,o.D$)(t=>L.updatePage(e),["prevent"])},(0,s.v_)(e),9,m)],2))),128)),l.pages.has_next?((0,a.uX)(),(0,a.CE)("li",h,[(0,a.Lk)("a",{class:"page-link",href:"#","aria-label":"Next",onClick:t[1]||(t[1]=(0,o.D$)(e=>L.updatePage(l.pages.current_page+1),["prevent"]))},[...t[4]||(t[4]=[(0,a.Lk)("span",{"aria-hidden":"true"},"»",-1)])])])):((0,a.uX)(),(0,a.CE)("li",k,[...t[5]||(t[5]=[(0,a.Lk)("span",{class:"page-link","aria-hidden":"true"},"»",-1)])]))])])])])])}var g={name:"PaginationModal",props:["pages"],methods:{updatePage(e){window.scrollTo({top:0}),this.$emit("emit-page",e)}}},L=l(1241);const f=(0,L.A)(g,[["render",b]]);var v=f}}]);
//# sourceMappingURL=803.03e8a70b.js.map