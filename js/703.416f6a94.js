"use strict";(self["webpackChunkcaffeineshop"]=self["webpackChunkcaffeineshop"]||[]).push([[703],{1716:function(e,t,o){o.d(t,{A:function(){return L}});var a=o(6768),n=o(4232);const l={class:"modal fade",id:"delModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},s={class:"modal-dialog",role:"document"},i={class:"modal-content border-0"},d={class:"modal-header bg-danger text-white"},p={class:"modal-title"},u={class:"modal-body"},c={class:"text-danger"},r={class:"modal-footer"};function m(e,t,o,m,h,k){return(0,a.uX)(),(0,a.CE)("div",l,[(0,a.Lk)("div",s,[(0,a.Lk)("div",i,[(0,a.Lk)("div",d,[(0,a.Lk)("h5",p,[(0,a.Lk)("span",null,"刪除 "+(0,n.v_)(o.item.title),1)]),t[1]||(t[1]=(0,a.Lk)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),(0,a.Lk)("div",u,[t[2]||(t[2]=(0,a.eW)("是否刪除",-1)),(0,a.Lk)("strong",c,(0,n.v_)(o.item.title),1),t[3]||(t[3]=(0,a.eW)(" (刪除後將無法恢復)。 ",-1))]),(0,a.Lk)("div",r,[t[4]||(t[4]=(0,a.Lk)("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"},"取消 ",-1)),(0,a.Lk)("button",{type:"button",class:"btn btn-danger",onClick:t[0]||(t[0]=t=>e.$emit("del-item",h.tempProduct))},"確認刪除")])])])],512)}var h=o(3286),k={name:"DelModal",props:{item:{type:Object,default(){return{}}}},data(){return{tempProduct:{}}},watch:{item(){this.tempProduct=this.item}},mixins:[h.A]},b=o(1241);const g=(0,b.A)(k,[["render",m]]);var L=g},5703:function(e,t,o){o.r(t),o.d(t,{default:function(){return T}});var a=o(6768),n=o(5130),l=o(4232);const s={class:"text-end"},i={class:"table mt-4"},d={"data-item":"名稱"},p={"data-item":"折扣百分比"},u={"data-item":"到期日"},c={"data-item":"是否啟用"},r={key:0,class:"text-success"},m={key:1,class:"text-muted"},h={"data-item":"編輯"},k={class:"btn-group"},b=["onClick"],g=["onClick"];function L(e,t,o,L,C,f){const v=(0,a.g2)("loading-modal"),M=(0,a.g2)("pagination-modal"),_=(0,a.g2)("coupon-modal"),y=(0,a.g2)("del-modal");return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.bF)(v,{active:C.isLoading},null,8,["active"]),t[3]||(t[3]=(0,a.Lk)("h1",null,"優惠券管理",-1)),(0,a.Lk)("div",s,[(0,a.Lk)("button",{class:"btn btn-brown",onClick:t[0]||(t[0]=(0,n.D$)(e=>f.openCouponModal(!0),["prevent"]))},[...t[1]||(t[1]=[(0,a.Lk)("i",{class:"bi bi-plus-square"},null,-1),(0,a.eW)(" 新增優惠券",-1)])])]),(0,a.Lk)("table",i,[t[2]||(t[2]=(0,a.Lk)("thead",null,[(0,a.Lk)("tr",null,[(0,a.Lk)("th",null,"名稱"),(0,a.Lk)("th",null,"折扣百分比"),(0,a.Lk)("th",null,"到期日"),(0,a.Lk)("th",null,"是否啟用"),(0,a.Lk)("th",null,"編輯")])],-1)),(0,a.Lk)("tbody",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(C.coupons,(t,o)=>((0,a.uX)(),(0,a.CE)("tr",{key:o},[(0,a.Lk)("td",d,(0,l.v_)(t.title),1),(0,a.Lk)("td",p,(0,l.v_)(t.percent),1),(0,a.Lk)("td",u,(0,l.v_)(e.$num.date(t.due_date)),1),(0,a.Lk)("td",c,[1===t.is_enabled?((0,a.uX)(),(0,a.CE)("span",r,"啟用")):((0,a.uX)(),(0,a.CE)("span",m,"未啟用"))]),(0,a.Lk)("td",h,[(0,a.Lk)("div",k,[(0,a.Lk)("button",{class:"btn btn-outline-primary btn-sm edit",onClick:e=>f.openCouponModal(!1,t)},null,8,b),(0,a.Lk)("button",{class:"btn btn-outline-danger btn-sm del",onClick:e=>f.openDelModal(t)},null,8,g)])])]))),128))])]),(0,a.bF)(M,{pages:C.pagination,onEmitPages:f.getCoupons},null,8,["pages","onEmitPages"]),(0,a.bF)(_,{ref:"couponModal",coupon:C.tempCoupon,onUpdateCoupon:f.updateCoupon},null,8,["coupon","onUpdateCoupon"]),(0,a.bF)(y,{ref:"delModal",item:C.tempCoupon,onDelItem:f.delCoupon},null,8,["item","onDelItem"])],64)}const C={class:"modal fade",id:"couponModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},f={class:"modal-dialog",role:"document"},v={class:"modal-content"},M={class:"modal-body"},_={class:"mb-3"},y={class:"mb-3"},$={class:"mb-3"},x={class:"mb-3"},w={class:"mb-3"},E={class:"form-check"},X={class:"modal-footer"};function D(e,t,o,l,s,i){return(0,a.uX)(),(0,a.CE)("div",C,[(0,a.Lk)("div",f,[(0,a.Lk)("div",v,[t[12]||(t[12]=(0,a.Lk)("div",{class:"modal-header"},[(0,a.Lk)("h5",{class:"modal-title",id:"exampleModalLabel"},"優惠券管理"),(0,a.Lk)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),(0,a.Lk)("div",M,[(0,a.Lk)("div",_,[t[6]||(t[6]=(0,a.Lk)("label",{for:"title"},"標題",-1)),(0,a.bo)((0,a.Lk)("input",{type:"text",class:"form-control",id:"title","onUpdate:modelValue":t[0]||(t[0]=e=>s.tempCoupon.title=e),placeholder:"請輸入標題"},null,512),[[n.Jo,s.tempCoupon.title]])]),(0,a.Lk)("div",y,[t[7]||(t[7]=(0,a.Lk)("label",{for:"coupon_code"},"優惠碼",-1)),(0,a.bo)((0,a.Lk)("input",{type:"text",class:"form-control",id:"coupon_code","onUpdate:modelValue":t[1]||(t[1]=e=>s.tempCoupon.code=e),placeholder:"請輸入優惠碼"},null,512),[[n.Jo,s.tempCoupon.code]])]),(0,a.Lk)("div",$,[t[8]||(t[8]=(0,a.Lk)("label",{for:"due_date"},"到期日",-1)),(0,a.bo)((0,a.Lk)("input",{type:"date",class:"form-control",id:"due_date","onUpdate:modelValue":t[2]||(t[2]=e=>s.due_date=e)},null,512),[[n.Jo,s.due_date]])]),(0,a.Lk)("div",x,[t[9]||(t[9]=(0,a.Lk)("label",{for:"price"},"折扣百分比",-1)),(0,a.bo)((0,a.Lk)("input",{type:"number",class:"form-control",id:"price","onUpdate:modelValue":t[3]||(t[3]=e=>s.tempCoupon.percent=e),placeholder:"請輸入折扣百分比"},null,512),[[n.Jo,s.tempCoupon.percent,void 0,{number:!0}]])]),(0,a.Lk)("div",w,[(0,a.Lk)("div",E,[(0,a.bo)((0,a.Lk)("input",{class:"form-check-input",type:"checkbox","true-value":1,"false-value":0,"onUpdate:modelValue":t[4]||(t[4]=e=>s.tempCoupon.is_enabled=e),id:"is_enabled"},null,512),[[n.lH,s.tempCoupon.is_enabled]]),t[10]||(t[10]=(0,a.Lk)("label",{class:"form-check-label",for:"is_enabled"},"是否啟用",-1))])])]),(0,a.Lk)("div",X,[t[11]||(t[11]=(0,a.Lk)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close",-1)),(0,a.Lk)("button",{type:"button",class:"btn btn-primary",onClick:t[5]||(t[5]=t=>e.$emit("update-coupon",s.tempCoupon))},"更新優惠券")])])])],512)}var P=o(3286),I={name:"CouponModal",data(){return{tempCoupon:{},due_date:""}},props:{coupon:{}},emits:["update-coupon"],watch:{coupon(){this.tempCoupon=this.coupon;const e=new Date(1e3*this.tempCoupon.due_date).toISOString().split("T");this.due_date=e[0]},due_date(){this.tempCoupon.due_date=Math.floor(new Date(this.due_date)/1e3)}},mixins:[P.A]},A=o(1241);const F=(0,A.A)(I,[["render",D]]);var U=F,N=o(1716),V=o(8589),J={components:{CouponModal:U,DelModal:N.A,PaginationModal:V.A},data(){return{coupons:{},tempCoupon:{title:"",is_enabled:0,percent:100,code:""},pagination:{},isNew:!1,isLoading:!1}},methods:{getCoupons(e=1){this.isLoading=!0;const t=`https://vue3-course-api.hexschool.io/api/caffeineshop/admin/coupons?page=${e}`;this.$http.get(t).then(e=>{this.coupons=e.data.coupons,console.log(this.coupons),this.pagination=e.data.pagination,this.isLoading=!1}).catch(e=>{this.isLoading=!1,this.$InformMessage(e,"取得優惠券列表")})},openCouponModal(e,t){this.isNew=e,this.isNew?this.tempCoupon={...this.tempCoupon,due_date:(new Date).getTime()/1e3}:this.tempCoupon={...t},this.$refs.couponModal.showModal()},updateCoupon(e){this.tempCoupon=e;let t="https://vue3-course-api.hexschool.io/api/caffeineshop/admin/coupon",o="post";this.isNew||(t=`${t}/${e.id}`,o="put"),this.$http[o](t,{data:this.tempCoupon}).then(e=>{"post"===o?this.$InformMessage(e,"優惠券新增"):this.$InformMessage(e,"優惠券更新"),this.$refs.couponModal.hideModal(),this.getCoupons(this.pagination.current_page)}).catch(e=>{this.$refs.couponModal.hideModal(),this.$InformMessage(e,"更新優惠券")})},openDelModal(e){this.tempCoupon={...e},this.$refs.delModal.showModal()},delCoupon(e){this.tempCoupon=e;const t=`https://vue3-course-api.hexschool.io/api/caffeineshop/admin/coupon/${this.tempCoupon.id}`;this.$http.delete(t,{data:this.tempCoupon}).then(t=>{this.$InformMessage(t,`優惠券${e.title}刪除`),this.$refs.delModal.hideModal(),this.getCoupons()}).catch(e=>{this.$refs.delModal.hideModal(),this.$InformMessage(e,"優惠券刪除")})}},created(){this.getCoupons()}};const K=(0,A.A)(J,[["render",L]]);var T=K},8589:function(e,t,o){o.d(t,{A:function(){return f}});var a=o(6768),n=o(5130),l=o(4232);const s={class:"container"},i={class:"row"},d={class:"col-12"},p={"aria-label":"Page navigation example"},u={class:"pagination justify-content-center"},c={key:0,class:"page-item"},r={key:1,class:"page-item disabled"},m=["onClick"],h={key:2,class:"page-item"},k={key:3,class:"page-item disabled"};function b(e,t,o,b,g,L){return(0,a.uX)(),(0,a.CE)("div",s,[(0,a.Lk)("div",i,[(0,a.Lk)("div",d,[(0,a.Lk)("nav",p,[(0,a.Lk)("ul",u,[o.pages.has_pre?((0,a.uX)(),(0,a.CE)("li",c,[(0,a.Lk)("a",{class:"page-link",href:"#","aria-label":"Previous",onClick:t[0]||(t[0]=(0,n.D$)(e=>L.updatePage(o.pages.current_page-1),["prevent"]))},[...t[2]||(t[2]=[(0,a.Lk)("span",{"aria-hidden":"true"},"«",-1)])])])):((0,a.uX)(),(0,a.CE)("li",r,[...t[3]||(t[3]=[(0,a.Lk)("span",{class:"page-link","aria-hidden":"true"},"«",-1)])])),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(o.pages.total_pages,e=>((0,a.uX)(),(0,a.CE)("li",{class:(0,l.C4)(["page-item",{active:e===o.pages.current_page}]),key:e},[(0,a.Lk)("a",{class:"page-link",href:"#",onClick:(0,n.D$)(t=>L.updatePage(e),["prevent"])},(0,l.v_)(e),9,m)],2))),128)),o.pages.has_next?((0,a.uX)(),(0,a.CE)("li",h,[(0,a.Lk)("a",{class:"page-link",href:"#","aria-label":"Next",onClick:t[1]||(t[1]=(0,n.D$)(e=>L.updatePage(o.pages.current_page+1),["prevent"]))},[...t[4]||(t[4]=[(0,a.Lk)("span",{"aria-hidden":"true"},"»",-1)])])])):((0,a.uX)(),(0,a.CE)("li",k,[...t[5]||(t[5]=[(0,a.Lk)("span",{class:"page-link","aria-hidden":"true"},"»",-1)])]))])])])])])}var g={name:"PaginationModal",props:["pages"],methods:{updatePage(e){window.scrollTo({top:0}),this.$emit("emit-page",e)}}},L=o(1241);const C=(0,L.A)(g,[["render",b]]);var f=C}}]);
//# sourceMappingURL=703.416f6a94.js.map