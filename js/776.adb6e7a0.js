"use strict";(self["webpackChunkcaffeineshop"]=self["webpackChunkcaffeineshop"]||[]).push([[776],{5306:function(t,s,i){i.d(s,{AS:function(){return e},Ap:function(){return M},FD:function(){return h},GW:function(){return l},Jj:function(){return u},Jv:function(){return g},QM:function(){return y},Xl:function(){return n},_t:function(){return x},b$:function(){return f},bE:function(){return c},c5:function(){return w},c8:function(){return I},e0:function(){return m},fS:function(){return d},iH:function(){return r},iY:function(){return k},k3:function(){return $},mx:function(){return v},n7:function(){return L},oo:function(){return a},r$:function(){return p}});i(4114),i(8111),i(7588);var o=i(1600);async function e(t){const s="https://vue3-course-api.hexschool.io/api/caffeineshop/products/all";try{const i=await t.get(s);return i.data.products}catch(i){const t=new Error("取得產品列表");t.original=t}}async function a(t,s){try{const i=`https://vue3-course-api.hexschool.io/api/caffeineshop/product/${s}`,o=await t.get(i);return o}catch(i){throw new Error("無法取得商品")}}async function n(t){const s="https://vue3-course-api.hexschool.io/api/caffeineshop/cart";try{const i=await this.$http.get(s),o=i.data.data;if(this.cart=o,this.cart.carts[0]?.coupon?.code&&(this.usedCoupon=this.cart.carts[0].coupon.code),this.num=o.carts.length,"check"===t)this.$emit("sendCart",this.cart);else if("cart"===t)return this.$emit("updateNum",this.num),this.cart.carts.length}catch(i){console.log(i),this.$InformMessage(i,"取得購物車資訊"),"cart"===t&&(this.err=!0)}}async function c(t,s,i,e,a){const n="https://vue3-course-api.hexschool.io/api/caffeineshop/cart";"detail"===e&&this.cartPutIn&&(this.cartPutIn=!this.cartPutIn),"list"===e&&(this.status.loadingItem=s);const c={product_id:s,qty:i};try{const s=await t.post(n,{data:c});if(console.log(s),"list"===e?this.cart=a:"detail"===e&&(this.cartPutIn=!0),"follow"!==e&&"cart"!==e)this.status.loadingItem="",this.$InformMessage(s,"商品放入購物車");else if("follow"===e||"cart"===e)return s;o.A.emit("updateCart")}catch(r){if("follow"!==e)this.status.loadingItem="",this.$InformMessage(r,"商品放入購物車");else if("follow"===e){const t=new Error("商品放入購物車");throw t.original=t,t}}}async function r(t,s){try{this.status.loadingItem=t.id;const i=`https://vue3-course-api.hexschool.io/api/caffeineshop/cart/${t.id}`,o={product_id:t.product_id,qty:t.qty};await this.$http.put(i,{data:o}),this.status.loadingItem="",this.getCart(s)}catch(i){this.status.loadingItem="",this.$InformMessage(i,"購物車更新")}}async function h(t,s){try{this.status.loadingItem=t;const i=`https://vue3-course-api.hexschool.io/api/caffeineshop/cart/${t}`;await this.$http.delete(i,{data:t}),this.status.loadingItem="",this.getCart(s)}catch(i){this.status.loadingItem="",this.$InformMessage(i,"商品刪除")}}async function u(t,s){try{const i="https://vue3-course-api.hexschool.io/api/caffeineshop/coupon",o={code:t},e=await s.post(i,{data:o});return e}catch(i){throw new Error(i)}}async function d(){const t="https://vue3-course-api.hexschool.io/api/caffeineshop/order",s=this.form;try{const i=await this.$http.post(t,{data:s});this.orderId=i.data.orderId}catch(i){this.$InformMessage(i,"送出訂單")}}async function p(t,s){this.isLoading=!0,"orderlist"===s&&(this.pageShow=!1,this.searchResult=[],this.notFound=!1,this.connectError=!1);const i=`https://vue3-course-api.hexschool.io/api/caffeineshop/order/${t}`;try{const t=await this.$http.get(i);this.isLoading=!1,"orderlist"===s?null!==t.data.order?this.searchResult.push(t.data.order):this.notFound=!0:"orderdetail"===s&&(this.order=t.data.order,this.user=t.data.order.user,Object.values(this.order.products).forEach((t,s)=>{this.total+=t.total}))}catch(o){this.isLoading=!1,this.notFound=!0}}async function l(t=1){this.pageShow=!0,this.isLoading=!0,!0===this.notFound&&(this.notFound=!1);const s=`https://vue3-course-api.hexschool.io/api/caffeineshop/orders?page=${t}`;try{const t=await this.$http.get(s);this.isLoading=!1,t.data.success&&(this.searchResult=t.data.orders,this.pagination=t.data.pagination)}catch(i){this.isLoading=!1,this.$InformMessage(i,"取得訂單列表")}}async function f(t,s){const i=`https://vue3-course-api.hexschool.io/api/caffeineshop/pay/${t}`;try{await s.post(i)}catch(o){throw new Error(o,"付款")}}async function g(){const t="https://vue3-course-api.hexschool.io/admin/signin";try{const s=await this.$http.post(t,this.user);if(s.data.success){const{token:t,expired:i}=s.data;this.$InformMessage(s,"登入"),document.cookie=`makotoToken=${t}; expires=${i}`,setTimeout(()=>{this.$router.push("/dashboard/productlist")},3e3)}}catch(s){this.$InformMessage(s,"登入")}}async function m(t=1){const s=`https://vue3-course-api.hexschool.io/api/caffeineshop/admin/products/?page=${t}`;this.isLoading=!0;try{const t=await this.$http.get(s);this.isLoading=!1,t.data.success&&(this.products=t.data.products,this.pagination=t.data.pagination)}catch(i){this.$InformMessage(i,"取得頁面資訊")}}async function $(t){this.tempProduct=t;let s="https://vue3-course-api.hexschool.io/api/caffeineshop/admin/product",i="post";this.isNew||(s=`${s}/${t.id}`,i="put");try{const t=await this.$http[i](s,{data:this.tempProduct});t.data.success&&("post"===i?this.$InformMessage(t,"商品新增"):this.$InformMessage(t,"商品更新"),this.getProducts(this.pagination.current_page)),this.$refs.productModal.hideModal()}catch(o){this.$InformMessage(o,"商品更新")}}async function y(t){try{const s=this.$refs[t].files[0],i=new FormData;i.append("file-to-upload",s);const o="https://vue3-course-api.hexschool.io/api/caffeineshop/admin/upload",e=await this.$http.post(o,i);e.data.success&&("fileInput"===t?this.tempProduct.imageUrl=e.data.imageUrl:this.tempProduct.imagesUrl.push(e.data.imageUrl))}catch(s){this.$InformMessage(s,"圖片上傳")}}async function w(t){this.tempProduct=t;const s=`https://vue3-course-api.hexschool.io/api/caffeineshop/admin/product/${t.id}`;try{const i=await this.$http.delete(s,{data:this.tempProduct});this.$InformMessage(i,`商品${t.title}刪除`),this.getProducts()}catch(i){this.$InformMessage(i,"商品刪除")}this.$refs.delModal.hideModal()}async function v(t=1){try{this.isLoading=!0;const s=`https://vue3-course-api.hexschool.io/api/caffeineshop/admin/coupons?page=${t}`,i=await this.$http.get(s);console.log(i),this.coupons=i.data.coupons,this.pagination=i.data.pagination,this.isLoading=!1}catch(s){this.isLoading=!1,this.$InformMessage(s,"取得優惠券列表")}}async function I(t){try{this.tempCoupon=t;let s="https://vue3-course-api.hexschool.io/api/caffeineshop/admin/coupon",i="post";this.isNew||(s=`${s}/${t.id}`,i="put");const o=await this.$http[i](s,{data:this.tempCoupon});"post"===i?this.$InformMessage(o,"優惠券新增"):this.$InformMessage(o,"優惠券更新"),this.$refs.couponModal.hideModal(),this.getCoupons(this.pagination.current_page)}catch(s){this.$refs.couponModal.hideModal(),this.$InformMessage(s,"更新優惠券")}}async function M(t){try{this.tempCoupon=t;const s=`https://vue3-course-api.hexschool.io/api/caffeineshop/admin/coupon/${this.tempCoupon.id}`,i=await this.$http.delete(s,{data:this.tempCoupon});this.$InformMessage(i,`優惠券${t.title}刪除`),this.$refs.delModal.hideModal(),this.getCoupons()}catch(s){this.$refs.delModal.hideModal(),this.$InformMessage(s,"優惠券刪除")}}async function L(t=1){const s=`https://vue3-course-api.hexschool.io/api/caffeineshop/admin/orders?page=${t}`;this.isLoading=!0;try{const t=await this.$http.get(s);this.isLoading=!1,this.orderList=t.data.orders,this.pagination=t.data.pagination}catch(i){this.$InformMessage(i,"取得訂單列表")}}async function k(t){this.tempOrder=t;const s=`https://vue3-course-api.hexschool.io/api/caffeineshop/admin/order/${this.tempOrder.id}`;try{await this.$http.put(s,{data:this.tempOrder}),this.$refs.orderModal.hideModal(),this.num=0,this.getOrderList(this.pagination.current_page)}catch(i){this.$InformMessage(i,"訂單更新")}}async function x(t){this.tempOrder=t;const s=`https://vue3-course-api.hexschool.io/api/caffeineshop/admin/order/${this.tempOrder.id}`;try{const t=await this.$http.delete(s,{data:this.tempOrder});this.$InformMessage(t,"訂單刪除"),this.$refs.delModal.hideModal(),this.getOrderList()}catch(i){this.$InformMessage(i,"訂單刪除")}}},7776:function(t,s,i){i.r(s),i.d(s,{default:function(){return E}});var o=i(6768),e=i(4232),a=i(5130);const n={class:"container"},c={class:"row"},r={class:"col-12"},h={class:"mt-4 mb-4"},u={class:"container"},d={key:0,class:"row"},p={class:"col-12 text-center"},l={class:"fs-3 fw-bold"},f={key:1,class:"row pb-5"},g={class:"card w-100 h-100 border"},m={class:"pt-2 px-2 text-end"},$=["onClick","disabled"],y={class:"p-2"},w=["src","alt"],v={class:"p-2 card-body d-flex flex-wrap flex-column justify-content-between"},I={class:"card-text fw-bold"},M={class:"w-100"},L=["onClick","disabled"];function k(t,s,i,k,x,b){const C=(0,o.g2)("router-link");return(0,o.uX)(),(0,o.CE)("div",n,[(0,o.Lk)("div",c,[(0,o.Lk)("div",r,[(0,o.Lk)("div",h,[(0,o.bF)(C,{to:"/",style:{"text-decoration":"none"}},{default:(0,o.k6)(()=>[...s[0]||(s[0]=[(0,o.eW)("首頁",-1)])]),_:1}),s[1]||(s[1]=(0,o.eW)(" > ",-1)),s[2]||(s[2]=(0,o.Lk)("span",null,"追蹤清單",-1))]),s[5]||(s[5]=(0,o.Lk)("h1",null,"追蹤清單",-1)),(0,o.Lk)("div",u,[0===x.length?((0,o.uX)(),(0,o.CE)("div",d,[(0,o.Lk)("div",p,[(0,o.Lk)("span",l,(0,e.v_)(this.word),1)])])):((0,o.uX)(),(0,o.CE)("div",f,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(b.filterData,(t,i)=>((0,o.uX)(),(0,o.CE)("div",{class:(0,e.C4)(["col-lg-3 col-md-4 col-sm-6 col-12 px-1 py-2",{fadeOut:this.num===i}]),key:i},[(0,o.Lk)("div",g,[(0,o.Lk)("div",m,[(0,o.Lk)("button",{class:"btn btn-outline-danger btn-sm",type:"button",onClick:(0,a.D$)(s=>b.deleteFavorite(t.id,i),["prevent"]),disabled:x.num!==i&&""!==x.num},[...s[3]||(s[3]=[(0,o.Lk)("i",{class:"bi bi-x-lg"},null,-1)])],8,$)]),(0,o.Lk)("div",y,[(0,o.Lk)("img",{src:b.filterData[i].imageUrl,class:"img-fluid",alt:t.title},null,8,w)]),(0,o.Lk)("div",v,[(0,o.Lk)("p",I,(0,e.v_)(t.title),1),(0,o.Lk)("div",M,[(0,o.Lk)("button",{class:"d-block btn btn-outline-brown w-100",type:"button",onClick:s=>b.addProduct(t.id,i,"follow"),disabled:x.num!==i&&""!==x.num},[...s[4]||(s[4]=[(0,o.Lk)("i",{class:"bi bi-cart3"},null,-1),(0,o.eW)(" 加入購物車 ",-1)])],8,L)])])])],2))),128))]))])])])])}i(4114),i(8111),i(7588),i(3110),i(8335);var x=i(5306),b={name:"FollowList",head(){return{title:"追蹤清單 - 咖啡因商店",meta:[{name:"description",content:"一間販賣咖啡因商品的網路店鋪"},{name:"keywords",content:"咖啡因商店,咖啡豆,濾掛式咖啡,茶葉,茶包,甜點"},{property:"og:title",content:"咖啡因商店"},{property:"og:image",content:"../../assets/logo/logo.png"},{property:"og:description",content:"一間販賣咖啡因商品的網路店鋪"}]}},data(){return{productList:[],length:0,status:{loadingItem:""},favorite:JSON.parse(localStorage.getItem("favoriteList"))||[],word:"追蹤清單載入中...",num:""}},methods:{async allProducts(){try{const t=await(0,x.AS)(this.$http);this.productList=t}catch(t){this.$InformMessage(t,"取得商品")}},deleteFavorite(t,s){const i=this.favorite.indexOf(t);this.num=s,setTimeout(()=>{this.num="",this.favorite.splice(i,1),localStorage.setItem("favoriteList",JSON.stringify(this.favorite))},500)},async addProduct(t,s,i){const o=this.favorite.indexOf(t);this.num=s,await new Promise(t=>setTimeout(t,1e3)),this.num="",this.favorite.splice(o,1),localStorage.setItem("favoriteList",JSON.stringify(this.favorite));try{const s=await(0,x.bE)(this.$http,t,1,i);this.$InformMessage(s,"商品放入購物車")}catch(e){this.$InformMessage(e.message)}}},computed:{filterData(){const t=[],s=this.favorite.length;return this.productList.forEach(i=>{for(let o=0;o<s;o++)i.id===this.favorite[o]&&t.push(i)}),t}},watch:{filterData(t,s){this.length=t.length,0===t.length&&(this.word="沒有追蹤商品哦...要不要加一點進來呢")}},created(){this.allProducts()}},C=i(1241);const P=(0,C.A)(b,[["render",k]]);var E=P}}]);
//# sourceMappingURL=776.adb6e7a0.js.map