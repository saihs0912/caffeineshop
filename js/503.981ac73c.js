"use strict";(self["webpackChunkcaffeineshop"]=self["webpackChunkcaffeineshop"]||[]).push([[503],{1510:function(t,e,i){i.d(e,{iDZ:function(){return T},lWr:function(){return W}});i(4114),i(6573),i(8100),i(7936),i(8111),i(1148),i(2489),i(116),i(531),i(7588),i(1701),i(8237),i(3579),i(3110),i(7642),i(8004),i(3853),i(5876),i(2475),i(5024),i(1698),i(9577),i(8335),i(1549),i(9797),i(9631),i(5623),i(4979),i(4603),i(7566),i(8721);var o=i(144),n=i(6768);function s(t){return!!(0,o.o5)()&&((0,o.jr)(t),!0)}const a=new WeakMap,r=(...t)=>{var e;const i=t[0],o=null==(e=(0,n.nI)())?void 0:e.proxy;if(null==o&&!(0,n.PS)())throw new Error("injectLocal must be called in setup");return o&&a.has(o)&&i in a.get(o)?a.get(o)[i]:(0,n.WQ)(...t)};const c="undefined"!==typeof window&&"undefined"!==typeof document,u=("undefined"!==typeof WorkerGlobalScope&&(globalThis,WorkerGlobalScope),Object.prototype.toString),h=t=>"[object Object]"===u.call(t);function d(t){let e;function i(){return e||(e=t()),e}return i.reset=async()=>{const t=e;e=void 0,t&&await t},i}function l(t){return t.endsWith("rem")?16*Number.parseFloat(t):Number.parseFloat(t)}function p(t){return Array.isArray(t)?t:[t]}function f(t){const e=Object.create(null);return i=>{const o=e[i];return o||(e[i]=t(i))}}const m=/\B([A-Z])/g,g=(f(t=>t.replace(m,"-$1").toLowerCase()),/-(\w)/g);f(t=>t.replace(g,(t,e)=>e?e.toUpperCase():""));function v(t){return t||(0,n.nI)()}function y(t,e=!0,i){const o=v(i);o?(0,n.sV)(t,i):e?t():(0,n.dY)(t)}function w(t,e,i={}){const{immediate:n=!0,immediateCallback:a=!1}=i,r=(0,o.IJ)(!1);let u;function h(){u&&(clearTimeout(u),u=void 0)}function d(){r.value=!1,h()}function l(...i){a&&t(),h(),r.value=!0,u=setTimeout(()=>{r.value=!1,u=void 0,t(...i)},(0,o.BA)(e))}return n&&(r.value=!0,c&&l()),s(d),{isPending:(0,o.nD)(r),start:l,stop:d}}function $(t,e,i){return(0,n.wB)(t,e,{...i,immediate:!0})}const I=c?window:void 0,M=(c&&window.document,c?window.navigator:void 0);c&&window.location;function b(t){var e;const i=(0,o.BA)(t);return null!=(e=null==i?void 0:i.$el)?e:i}function x(...t){const e=[],i=()=>{e.forEach(t=>t()),e.length=0},a=(t,e,i,o)=>(t.addEventListener(e,i,o),()=>t.removeEventListener(e,i,o)),r=(0,n.EW)(()=>{const e=p((0,o.BA)(t[0])).filter(t=>null!=t);return e.every(t=>"string"!==typeof t)?e:void 0}),c=$(()=>{var e,i;return[null!=(i=null==(e=r.value)?void 0:e.map(t=>b(t)))?i:[I].filter(t=>null!=t),p((0,o.BA)(r.value?t[1]:t[0])),p((0,o.R1)(r.value?t[2]:t[1])),(0,o.BA)(r.value?t[3]:t[2])]},([t,o,n,s])=>{if(i(),!(null==t?void 0:t.length)||!(null==o?void 0:o.length)||!(null==n?void 0:n.length))return;const r=h(s)?{...s}:s;e.push(...t.flatMap(t=>o.flatMap(e=>n.map(i=>a(t,e,i,r)))))},{flush:"post"}),u=()=>{c(),i()};return s(i),u}function E(){const t=(0,o.IJ)(!1),e=(0,n.nI)();return e&&(0,n.sV)(()=>{t.value=!0},e),t}function L(t){const e=E();return(0,n.EW)(()=>(e.value,Boolean(t())))}const C=Symbol("vueuse-ssr-width");function P(){const t=(0,n.PS)()?r(C,null):null;return"number"===typeof t?t:void 0}function S(t,e={}){const{window:i=I,ssrWidth:s=P()}=e,a=L(()=>i&&"matchMedia"in i&&"function"===typeof i.matchMedia),r=(0,o.IJ)("number"===typeof s),c=(0,o.IJ)(),u=(0,o.IJ)(!1),h=t=>{u.value=t.matches};return(0,n.nT)(()=>{if(r.value){r.value=!a.value;const e=(0,o.BA)(t).split(",");return void(u.value=e.some(t=>{const e=t.includes("not all"),i=t.match(/\(\s*min-width:\s*(-?\d+(?:\.\d*)?[a-z]+\s*)\)/),o=t.match(/\(\s*max-width:\s*(-?\d+(?:\.\d*)?[a-z]+\s*)\)/);let n=Boolean(i||o);return i&&n&&(n=s>=l(i[1])),o&&n&&(n=s<=l(o[1])),e?!n:n}))}a.value&&(c.value=i.matchMedia((0,o.BA)(t)),u.value=c.value.matches)}),x(c,"change",h,{passive:!0}),(0,n.EW)(()=>u.value)}function O(t,e={}){const{controls:i=!1,navigator:n=M}=e,s=L(()=>n&&"permissions"in n),a=(0,o.IJ)(),r="string"===typeof t?{name:t}:t,c=(0,o.IJ)(),u=()=>{var t,e;c.value=null!=(e=null==(t=a.value)?void 0:t.state)?e:"prompt"};x(a,"change",u,{passive:!0});const h=d(async()=>{if(s.value){if(!a.value)try{a.value=await n.permissions.query(r)}catch(t){a.value=void 0}finally{u()}return i?(0,o.ux)(a.value):void 0}});return h(),i?{state:c,isSupported:s,query:h}:c}function T(t={}){const{navigator:e=M,read:i=!1,source:s,copiedDuring:a=1500,legacy:r=!1}=t,c=L(()=>e&&"clipboard"in e),u=O("clipboard-read"),h=O("clipboard-write"),d=(0,n.EW)(()=>c.value||r),l=(0,o.IJ)(""),p=(0,o.IJ)(!1),f=w(()=>p.value=!1,a,{immediate:!1});async function m(){let t=!(c.value&&$(u.value));if(!t)try{l.value=await e.clipboard.readText()}catch(i){t=!0}t&&(l.value=y())}async function g(t=(0,o.BA)(s)){if(d.value&&null!=t){let o=!(c.value&&$(h.value));if(!o)try{await e.clipboard.writeText(t)}catch(i){o=!0}o&&v(t),l.value=t,p.value=!0,f.start()}}function v(t){const e=document.createElement("textarea");e.value=null!=t?t:"",e.style.position="absolute",e.style.opacity="0",document.body.appendChild(e),e.select(),document.execCommand("copy"),e.remove()}function y(){var t,e,i;return null!=(i=null==(e=null==(t=null==document?void 0:document.getSelection)?void 0:t.call(document))?void 0:e.toString())?i:""}function $(t){return"granted"===t||"prompt"===t}return d.value&&i&&x(["copy","cut"],m,{passive:!0}),{isSupported:d,text:l,copied:p,copy:g}}"undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof i.g?i.g:"undefined"!==typeof self&&self;Number.POSITIVE_INFINITY;function W(t={}){const{window:e=I,initialWidth:i=Number.POSITIVE_INFINITY,initialHeight:s=Number.POSITIVE_INFINITY,listenOrientation:a=!0,includeScrollbar:r=!0,type:c="inner"}=t,u=(0,o.IJ)(i),h=(0,o.IJ)(s),d=()=>{if(e)if("outer"===c)u.value=e.outerWidth,h.value=e.outerHeight;else if("visual"===c&&e.visualViewport){const{width:t,height:i,scale:o}=e.visualViewport;u.value=Math.round(t*o),h.value=Math.round(i*o)}else r?(u.value=e.innerWidth,h.value=e.innerHeight):(u.value=e.document.documentElement.clientWidth,h.value=e.document.documentElement.clientHeight)};d(),y(d);const l={passive:!0};if(x("resize",d,l),e&&"visual"===c&&e.visualViewport&&x(e.visualViewport,"resize",d,l),a){const t=S("(orientation: portrait)");(0,n.wB)(t,()=>d())}return{width:u,height:h}}},5306:function(t,e,i){i.d(e,{AS:function(){return n},Ap:function(){return M},FD:function(){return u},GW:function(){return p},Jj:function(){return h},Jv:function(){return m},QM:function(){return y},Xl:function(){return a},_t:function(){return E},b$:function(){return f},bE:function(){return r},c5:function(){return w},c8:function(){return I},e0:function(){return g},fS:function(){return d},iH:function(){return c},iY:function(){return x},k3:function(){return v},mx:function(){return $},n7:function(){return b},oo:function(){return s},r$:function(){return l}});i(4114),i(8111),i(7588);var o=i(1600);async function n(t){const e="https://vue3-course-api.hexschool.io/api/caffeineshop/products/all";try{const i=await t.get(e);return i.data.products}catch(i){const t=new Error("取得產品列表");t.original=t}}async function s(t,e){try{const i=`https://vue3-course-api.hexschool.io/api/caffeineshop/product/${e}`,o=await t.get(i);return o}catch(i){throw new Error("無法取得商品")}}async function a(t){const e="https://vue3-course-api.hexschool.io/api/caffeineshop/cart";try{const i=await this.$http.get(e),o=i.data.data;if(this.cart=o,this.cart.carts[0]?.coupon?.code&&(this.usedCoupon=this.cart.carts[0].coupon.code),this.num=o.carts.length,"check"===t)this.$emit("sendCart",this.cart);else if("cart"===t)return this.$emit("updateNum",this.num),this.cart.carts.length}catch(i){console.log(i),this.$InformMessage(i,"取得購物車資訊"),"cart"===t&&(this.err=!0)}}async function r(t,e,i,n,s){const a="https://vue3-course-api.hexschool.io/api/caffeineshop/cart";"detail"===n&&this.cartPutIn&&(this.cartPutIn=!this.cartPutIn),"list"===n&&(this.status.loadingItem=e);const r={product_id:e,qty:i};try{const e=await t.post(a,{data:r});if(console.log(e),"list"===n?this.cart=s:"detail"===n&&(this.cartPutIn=!0),"follow"!==n&&"cart"!==n)this.status.loadingItem="",this.$InformMessage(e,"商品放入購物車");else if("follow"===n||"cart"===n)return e;o.A.emit("updateCart")}catch(c){if("follow"!==n)this.status.loadingItem="",this.$InformMessage(c,"商品放入購物車");else if("follow"===n){const t=new Error("商品放入購物車");throw t.original=t,t}}}async function c(t,e){try{this.status.loadingItem=t.id;const i=`https://vue3-course-api.hexschool.io/api/caffeineshop/cart/${t.id}`,o={product_id:t.product_id,qty:t.qty};await this.$http.put(i,{data:o}),this.status.loadingItem="",this.getCart(e)}catch(i){this.status.loadingItem="",this.$InformMessage(i,"購物車更新")}}async function u(t,e){try{this.status.loadingItem=t;const i=`https://vue3-course-api.hexschool.io/api/caffeineshop/cart/${t}`;await this.$http.delete(i,{data:t}),this.status.loadingItem="",this.getCart(e)}catch(i){this.status.loadingItem="",this.$InformMessage(i,"商品刪除")}}async function h(t,e){try{const i="https://vue3-course-api.hexschool.io/api/caffeineshop/coupon",o={code:t},n=await e.post(i,{data:o});return n}catch(i){throw new Error(i)}}async function d(){const t="https://vue3-course-api.hexschool.io/api/caffeineshop/order",e=this.form;try{const i=await this.$http.post(t,{data:e});this.orderId=i.data.orderId}catch(i){this.$InformMessage(i,"送出訂單")}}async function l(t,e){this.isLoading=!0,"orderlist"===e&&(this.pageShow=!1,this.searchResult=[],this.notFound=!1,this.connectError=!1);const i=`https://vue3-course-api.hexschool.io/api/caffeineshop/order/${t}`;try{const t=await this.$http.get(i);this.isLoading=!1,"orderlist"===e?null!==t.data.order?this.searchResult.push(t.data.order):this.notFound=!0:"orderdetail"===e&&(this.order=t.data.order,this.user=t.data.order.user,Object.values(this.order.products).forEach((t,e)=>{this.total+=t.total}))}catch(o){this.isLoading=!1,this.notFound=!0}}async function p(t=1){this.pageShow=!0,this.isLoading=!0,!0===this.notFound&&(this.notFound=!1);const e=`https://vue3-course-api.hexschool.io/api/caffeineshop/orders?page=${t}`;try{const t=await this.$http.get(e);this.isLoading=!1,t.data.success&&(this.searchResult=t.data.orders,this.pagination=t.data.pagination)}catch(i){this.isLoading=!1,this.$InformMessage(i,"取得訂單列表")}}async function f(t,e){const i=`https://vue3-course-api.hexschool.io/api/caffeineshop/pay/${t}`;try{await e.post(i)}catch(o){throw new Error(o,"付款")}}async function m(){const t="https://vue3-course-api.hexschool.io/admin/signin";try{const e=await this.$http.post(t,this.user);if(e.data.success){const{token:t,expired:i}=e.data;this.$InformMessage(e,"登入"),document.cookie=`makotoToken=${t}; expires=${i}`,setTimeout(()=>{this.$router.push("/dashboard/productlist")},3e3)}}catch(e){this.$InformMessage(e,"登入")}}async function g(t=1){const e=`https://vue3-course-api.hexschool.io/api/caffeineshop/admin/products/?page=${t}`;this.isLoading=!0;try{const t=await this.$http.get(e);this.isLoading=!1,t.data.success&&(this.products=t.data.products,this.pagination=t.data.pagination)}catch(i){this.$InformMessage(i,"取得頁面資訊")}}async function v(t){this.tempProduct=t;let e="https://vue3-course-api.hexschool.io/api/caffeineshop/admin/product",i="post";this.isNew||(e=`${e}/${t.id}`,i="put");try{const t=await this.$http[i](e,{data:this.tempProduct});t.data.success&&("post"===i?this.$InformMessage(t,"商品新增"):this.$InformMessage(t,"商品更新"),this.getProducts(this.pagination.current_page)),this.$refs.productModal.hideModal()}catch(o){this.$InformMessage(o,"商品更新")}}async function y(t){try{const e=this.$refs[t].files[0],i=new FormData;i.append("file-to-upload",e);const o="https://vue3-course-api.hexschool.io/api/caffeineshop/admin/upload",n=await this.$http.post(o,i);n.data.success&&("fileInput"===t?this.tempProduct.imageUrl=n.data.imageUrl:this.tempProduct.imagesUrl.push(n.data.imageUrl))}catch(e){this.$InformMessage(e,"圖片上傳")}}async function w(t){this.tempProduct=t;const e=`https://vue3-course-api.hexschool.io/api/caffeineshop/admin/product/${t.id}`;try{const i=await this.$http.delete(e,{data:this.tempProduct});this.$InformMessage(i,`商品${t.title}刪除`),this.getProducts()}catch(i){this.$InformMessage(i,"商品刪除")}this.$refs.delModal.hideModal()}async function $(t=1){try{this.isLoading=!0;const e=`https://vue3-course-api.hexschool.io/api/caffeineshop/admin/coupons?page=${t}`,i=await this.$http.get(e);console.log(i),this.coupons=i.data.coupons,this.pagination=i.data.pagination,this.isLoading=!1}catch(e){this.isLoading=!1,this.$InformMessage(e,"取得優惠券列表")}}async function I(t){try{this.tempCoupon=t;let e="https://vue3-course-api.hexschool.io/api/caffeineshop/admin/coupon",i="post";this.isNew||(e=`${e}/${t.id}`,i="put");const o=await this.$http[i](e,{data:this.tempCoupon});"post"===i?this.$InformMessage(o,"優惠券新增"):this.$InformMessage(o,"優惠券更新"),this.$refs.couponModal.hideModal(),this.getCoupons(this.pagination.current_page)}catch(e){this.$refs.couponModal.hideModal(),this.$InformMessage(e,"更新優惠券")}}async function M(t){try{this.tempCoupon=t;const e=`https://vue3-course-api.hexschool.io/api/caffeineshop/admin/coupon/${this.tempCoupon.id}`,i=await this.$http.delete(e,{data:this.tempCoupon});this.$InformMessage(i,`優惠券${t.title}刪除`),this.$refs.delModal.hideModal(),this.getCoupons()}catch(e){this.$refs.delModal.hideModal(),this.$InformMessage(e,"優惠券刪除")}}async function b(t=1){const e=`https://vue3-course-api.hexschool.io/api/caffeineshop/admin/orders?page=${t}`;this.isLoading=!0;try{const t=await this.$http.get(e);this.isLoading=!1,this.orderList=t.data.orders,this.pagination=t.data.pagination}catch(i){this.$InformMessage(i,"取得訂單列表")}}async function x(t){this.tempOrder=t;const e=`https://vue3-course-api.hexschool.io/api/caffeineshop/admin/order/${this.tempOrder.id}`;try{await this.$http.put(e,{data:this.tempOrder}),this.$refs.orderModal.hideModal(),this.num=0,this.getOrderList(this.pagination.current_page)}catch(i){this.$InformMessage(i,"訂單更新")}}async function E(t){this.tempOrder=t;const e=`https://vue3-course-api.hexschool.io/api/caffeineshop/admin/order/${this.tempOrder.id}`;try{const t=await this.$http.delete(e,{data:this.tempOrder});this.$InformMessage(t,"訂單刪除"),this.$refs.delModal.hideModal(),this.getOrderList()}catch(i){this.$InformMessage(i,"訂單刪除")}}}}]);
//# sourceMappingURL=503.981ac73c.js.map