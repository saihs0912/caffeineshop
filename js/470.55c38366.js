"use strict";(self["webpackChunkcaffeineshop"]=self["webpackChunkcaffeineshop"]||[]).push([[470],{1814:function(e,t,a){a.d(t,{A:function(){return v}});var o=a(6768),n=a(5130),l=a(4232);const s={class:"container"},d={class:"row"},i={class:"col-12"},u={"aria-label":"Page navigation example"},p={class:"pagination justify-content-center"},c={key:0,class:"page-item"},r={key:1,class:"page-item disabled"},m=["onClick"],k={key:2,class:"page-item"},b={key:3,class:"page-item disabled"};function L(e,t,a,L,C,h){return(0,o.uX)(),(0,o.CE)("div",s,[(0,o.Lk)("div",d,[(0,o.Lk)("div",i,[(0,o.Lk)("nav",u,[(0,o.Lk)("ul",p,[a.pages.has_pre?((0,o.uX)(),(0,o.CE)("li",c,[(0,o.Lk)("a",{class:"page-link",href:"#","aria-label":"Previous",onClick:t[0]||(t[0]=(0,n.D$)(e=>h.updatePage(a.pages.current_page-1),["prevent"]))},[...t[2]||(t[2]=[(0,o.Lk)("span",{"aria-hidden":"true"},"«",-1)])])])):((0,o.uX)(),(0,o.CE)("li",r,[...t[3]||(t[3]=[(0,o.Lk)("span",{class:"page-link","aria-hidden":"true"},"«",-1)])])),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(a.pages.total_pages,e=>((0,o.uX)(),(0,o.CE)("li",{class:(0,l.C4)(["page-item",{active:e===a.pages.current_page}]),key:e},[(0,o.Lk)("a",{class:"page-link",href:"#",onClick:(0,n.D$)(t=>h.updatePage(e),["prevent"])},(0,l.v_)(e),9,m)],2))),128)),a.pages.has_next?((0,o.uX)(),(0,o.CE)("li",k,[(0,o.Lk)("a",{class:"page-link",href:"#","aria-label":"Next",onClick:t[1]||(t[1]=(0,n.D$)(e=>h.updatePage(a.pages.current_page+1),["prevent"]))},[...t[4]||(t[4]=[(0,o.Lk)("span",{"aria-hidden":"true"},"»",-1)])])])):((0,o.uX)(),(0,o.CE)("li",b,[...t[5]||(t[5]=[(0,o.Lk)("span",{class:"page-link","aria-hidden":"true"},"»",-1)])]))])])])])])}var C={name:"PaginationModal",props:["pages"],methods:{updatePage(e){window.scrollTo({top:0}),this.$emit("emit-page",e)}}},h=a(1241);const g=(0,h.A)(C,[["render",L]]);var v=g},2470:function(e,t,a){a.r(t),a.d(t,{default:function(){return W}});var o=a(6768),n=a(5130),l=a(4232);const s={class:"text-end"},d={class:"table mt-4"},i={"data-item":"名稱"},u={"data-item":"折扣百分比"},p={"data-item":"到期日"},c={"data-item":"是否啟用"},r={key:0,class:"text-success"},m={key:1,class:"text-muted"},k={"data-item":"編輯"},b={class:"btn-group"},L=["onClick"],C=["onClick"];function h(e,t,a,h,g,v){const f=(0,o.g2)("loading-modal"),_=(0,o.g2)("pagination-modal"),y=(0,o.g2)("coupon-modal"),M=(0,o.g2)("del-modal");return(0,o.uX)(),(0,o.CE)(o.FK,null,[(0,o.bF)(f,{active:g.isLoading},null,8,["active"]),t[3]||(t[3]=(0,o.Lk)("h1",null,"優惠券管理",-1)),(0,o.Lk)("div",s,[(0,o.Lk)("button",{class:"btn btn-brown",onClick:t[0]||(t[0]=(0,n.D$)(e=>v.openCouponModal(!0),["prevent"]))},[...t[1]||(t[1]=[(0,o.Lk)("i",{class:"bi bi-plus-square"},null,-1),(0,o.eW)(" 新增優惠券 ",-1)])])]),(0,o.Lk)("table",d,[t[2]||(t[2]=(0,o.Lk)("thead",null,[(0,o.Lk)("tr",null,[(0,o.Lk)("th",null,"名稱"),(0,o.Lk)("th",null,"折扣百分比"),(0,o.Lk)("th",null,"到期日"),(0,o.Lk)("th",null,"是否啟用"),(0,o.Lk)("th",null,"編輯")])],-1)),(0,o.Lk)("tbody",null,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(g.coupons,(t,a)=>((0,o.uX)(),(0,o.CE)("tr",{key:a},[(0,o.Lk)("td",i,(0,l.v_)(t.title),1),(0,o.Lk)("td",u,(0,l.v_)(v.unitsDigit(t.percent))+"折",1),(0,o.Lk)("td",p,(0,l.v_)(e.$num.date(t.due_date)),1),(0,o.Lk)("td",c,[1===t.is_enabled?((0,o.uX)(),(0,o.CE)("span",r,"啟用")):((0,o.uX)(),(0,o.CE)("span",m,"未啟用"))]),(0,o.Lk)("td",k,[(0,o.Lk)("div",b,[(0,o.Lk)("button",{class:"btn btn-outline-primary btn-sm edit",onClick:e=>v.openCouponModal(!1,t)},null,8,L),(0,o.Lk)("button",{class:"btn btn-outline-danger btn-sm del",onClick:e=>v.openDelModal(t)},null,8,C)])])]))),128))])]),(0,o.bF)(_,{pages:g.pagination,onEmitPages:v.getCoupons},null,8,["pages","onEmitPages"]),(0,o.bF)(y,{ref:"couponModal",coupon:g.tempCoupon,onUpdateCoupon:v.updateCoupon},null,8,["coupon","onUpdateCoupon"]),(0,o.bF)(M,{ref:"delModal",item:g.tempCoupon,onDelItem:v.delCoupon},null,8,["item","onDelItem"])],64)}const g={class:"modal fade",id:"couponModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},v={class:"modal-dialog",role:"document"},f={class:"modal-content"},_={class:"modal-body"},y={class:"mb-3"},M={class:"mb-3"},x={class:"mb-3"},w={class:"mb-3"},E={class:"mb-3"},D={class:"form-check"},X={class:"modal-footer"};function P(e,t,a,l,s,d){return(0,o.uX)(),(0,o.CE)("div",g,[(0,o.Lk)("div",v,[(0,o.Lk)("div",f,[t[12]||(t[12]=(0,o.Lk)("div",{class:"modal-header"},[(0,o.Lk)("h5",{class:"modal-title",id:"exampleModalLabel"},"優惠券管理"),(0,o.Lk)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),(0,o.Lk)("div",_,[(0,o.Lk)("div",y,[t[6]||(t[6]=(0,o.Lk)("label",{for:"title"},"標題",-1)),(0,o.bo)((0,o.Lk)("input",{type:"text",class:"form-control",id:"title","onUpdate:modelValue":t[0]||(t[0]=e=>s.tempCoupon.title=e),placeholder:"請輸入標題"},null,512),[[n.Jo,s.tempCoupon.title]])]),(0,o.Lk)("div",M,[t[7]||(t[7]=(0,o.Lk)("label",{for:"coupon_code"},"優惠碼",-1)),(0,o.bo)((0,o.Lk)("input",{type:"text",class:"form-control",id:"coupon_code","onUpdate:modelValue":t[1]||(t[1]=e=>s.tempCoupon.code=e),placeholder:"請輸入優惠碼"},null,512),[[n.Jo,s.tempCoupon.code]])]),(0,o.Lk)("div",x,[t[8]||(t[8]=(0,o.Lk)("label",{for:"due_date"},"到期日",-1)),(0,o.bo)((0,o.Lk)("input",{type:"date",class:"form-control",id:"due_date","onUpdate:modelValue":t[2]||(t[2]=e=>s.due_date=e)},null,512),[[n.Jo,s.due_date]])]),(0,o.Lk)("div",w,[t[9]||(t[9]=(0,o.Lk)("label",{for:"price"},"折扣百分比",-1)),(0,o.bo)((0,o.Lk)("input",{type:"number",class:"form-control",id:"price","onUpdate:modelValue":t[3]||(t[3]=e=>s.tempCoupon.percent=e),placeholder:"請輸入折扣百分比"},null,512),[[n.Jo,s.tempCoupon.percent,void 0,{number:!0}]])]),(0,o.Lk)("div",E,[(0,o.Lk)("div",D,[(0,o.bo)((0,o.Lk)("input",{class:"form-check-input",type:"checkbox","true-value":1,"false-value":0,"onUpdate:modelValue":t[4]||(t[4]=e=>s.tempCoupon.is_enabled=e),id:"is_enabled"},null,512),[[n.lH,s.tempCoupon.is_enabled]]),t[10]||(t[10]=(0,o.Lk)("label",{class:"form-check-label",for:"is_enabled"},"是否啟用",-1))])])]),(0,o.Lk)("div",X,[t[11]||(t[11]=(0,o.Lk)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close",-1)),(0,o.Lk)("button",{type:"button",class:"btn btn-primary",onClick:t[5]||(t[5]=(...e)=>d.sendCoupon&&d.sendCoupon(...e))},"更新優惠券")])])])],512)}var A=a(3286),$={name:"CouponModal",data(){return{tempCoupon:{},due_date:""}},props:{coupon:{}},emits:["update-coupon"],watch:{coupon(){this.tempCoupon=this.coupon;const e=new Date(1e3*this.tempCoupon.due_date).toISOString().split("T");this.due_date=e[0]},due_date(){this.tempCoupon.due_date=Math.floor(new Date(this.due_date)/1e3)}},methods:{sendCoupon(){return this.tempCoupon.title?this.tempCoupon.code?this.due_date?this.tempCoupon.percent?void this.$emit("update-coupon",this.tempCoupon):(alert("沒有填寫折扣百分比！"),!1):(alert("沒有填寫到期日！"),!1):(alert("沒有填寫優惠碼！"),!1):(alert("沒有填寫優惠券名稱！"),!1)}},mixins:[A.A]},F=a(1241);const U=(0,F.A)($,[["render",P]]);var I=U,V=a(8208),J=a(1814),N=a(5306),K={head(){return{title:"優惠券管理"}},components:{CouponModal:I,DelModal:V.A,PaginationModal:J.A},data(){return{coupons:{},tempCoupon:{title:"",is_enabled:0,percent:100,code:""},pagination:{},isNew:!1,isLoading:!1}},methods:{getCoupons:N.mx,openCouponModal(e,t){this.isNew=e,this.isNew?this.tempCoupon={...this.tempCoupon,due_date:(new Date).getTime()/1e3}:this.tempCoupon={...t},this.$refs.couponModal.showModal()},updateCoupon:N.c8,openDelModal(e){this.tempCoupon={...e},this.$refs.delModal.showModal()},delCoupon:N.Ap,unitsDigit(e){return e%10===0?e/10:e}},created(){this.getCoupons()}};const T=(0,F.A)(K,[["render",h]]);var W=T},8208:function(e,t,a){a.d(t,{A:function(){return h}});var o=a(6768),n=a(4232);const l={class:"modal fade",id:"delModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},s={class:"modal-dialog",role:"document"},d={class:"modal-content border-0"},i={class:"modal-header bg-danger text-white"},u={class:"modal-title"},p={class:"modal-body"},c={class:"text-danger"},r={class:"modal-footer"};function m(e,t,a,m,k,b){return(0,o.uX)(),(0,o.CE)("div",l,[(0,o.Lk)("div",s,[(0,o.Lk)("div",d,[(0,o.Lk)("div",i,[(0,o.Lk)("h5",u,[(0,o.Lk)("span",null,"刪除 "+(0,n.v_)(a.item.title),1)]),t[1]||(t[1]=(0,o.Lk)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),(0,o.Lk)("div",p,[t[2]||(t[2]=(0,o.eW)(" 是否刪除",-1)),(0,o.Lk)("strong",c,(0,n.v_)(a.item.title),1),t[3]||(t[3]=(0,o.eW)(" (刪除後將無法恢復)。 ",-1))]),(0,o.Lk)("div",r,[t[4]||(t[4]=(0,o.Lk)("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1)),(0,o.Lk)("button",{type:"button",class:"btn btn-danger",onClick:t[0]||(t[0]=t=>e.$emit("del-item",k.tempProduct))}," 確認刪除 ")])])])],512)}var k=a(3286),b={name:"DelModal",props:{item:{type:Object,default(){return{}}}},data(){return{tempProduct:{}}},watch:{item(){this.tempProduct=this.item}},mixins:[k.A]},L=a(1241);const C=(0,L.A)(b,[["render",m]]);var h=C}}]);
//# sourceMappingURL=470.55c38366.js.map