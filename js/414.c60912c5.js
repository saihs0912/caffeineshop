"use strict";(self["webpackChunkcaffeineshop"]=self["webpackChunkcaffeineshop"]||[]).push([[414],{1414:function(e,t,a){a.r(t),a.d(t,{default:function(){return A}});var l=a(6768),s=a(4232);const d={class:"table mt-4"},r={key:0,class:"text-danger"},o={key:1,class:"text-success"},n={class:"btn-group"},i=["onClick"],c=["onClick"];function p(e,t,a,p,u,m){const h=(0,l.g2)("loading-modal"),k=(0,l.g2)("order-modal"),g=(0,l.g2)("del-modal"),L=(0,l.g2)("pagination-modal");return(0,l.uX)(),(0,l.CE)(l.FK,null,[(0,l.bF)(h,{active:u.isLoading},null,8,["active"]),t[1]||(t[1]=(0,l.Lk)("h1",null,"訂單管理",-1)),(0,l.Lk)("div",null,[(0,l.Lk)("table",d,[t[0]||(t[0]=(0,l.Lk)("thead",null,[(0,l.Lk)("tr",null,[(0,l.Lk)("th",null,"結單日期"),(0,l.Lk)("th",null,"訂購者"),(0,l.Lk)("th",null,"訂單編號"),(0,l.Lk)("th",null,"是否已付款"),(0,l.Lk)("th",null,"總金額"),(0,l.Lk)("th",null,"編輯")])],-1)),(0,l.Lk)("tbody",null,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(u.orderList,t=>((0,l.uX)(),(0,l.CE)("tr",{key:t.id},[(0,l.Lk)("td",null,(0,s.v_)(e.$num.date(t.create_at)),1),(0,l.Lk)("td",null,(0,s.v_)(t.user.name),1),(0,l.Lk)("td",null,(0,s.v_)(t.id),1),(0,l.Lk)("td",null,[0==t.is_paid?((0,l.uX)(),(0,l.CE)("span",r,"尚未付款")):((0,l.uX)(),(0,l.CE)("span",o,"已於"+(0,s.v_)(e.$num.date(t.paid_date))+"通知付款",1))]),(0,l.Lk)("td",null,(0,s.v_)(e.$num.currency(t.total)),1),(0,l.Lk)("td",null,[(0,l.Lk)("div",n,[(0,l.Lk)("button",{class:"btn btn-outline-primary btn-sm edit",onClick:e=>m.openOrderModal(t)},null,8,i),(0,l.Lk)("button",{class:"btn btn-outline-danger btn-sm del",onClick:e=>m.openDelModal(t)},null,8,c)])])]))),128))])])]),(0,l.bF)(k,{ref:"orderModal",order:u.tempOrder,onSendOrder:m.updateOrder},null,8,["order","onSendOrder"]),(0,l.bF)(g,{ref:"delModal",item:u.tempOrder,onDelItem:m.delOrder},null,8,["item","onDelItem"]),(0,l.bF)(L,{pages:u.pagination,onEmitPage:m.getOrderList},null,8,["pages","onEmitPage"])],64)}var u=a(5130);const m={class:"modal fade",id:"couponModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},h={class:"modal-dialog",role:"document"},k={class:"modal-content"},g={class:"modal-body"},L={class:"mb-3"},b={class:"mb-3"},f={class:"mb-3"},v={class:"mb-3"},O={class:"form-check"},_={class:"modal-footer"};function C(e,t,a,s,d,r){return(0,l.uX)(),(0,l.CE)("div",m,[(0,l.Lk)("div",h,[(0,l.Lk)("div",k,[t[10]||(t[10]=(0,l.Lk)("div",{class:"modal-header"},[(0,l.Lk)("h5",{class:"modal-title",id:"exampleModalLabel"},"訂單編輯"),(0,l.Lk)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),(0,l.Lk)("div",g,[(0,l.Lk)("div",L,[t[5]||(t[5]=(0,l.Lk)("label",{for:"date"},"訂單日期",-1)),(0,l.bo)((0,l.Lk)("input",{type:"date",class:"form-control",id:"date","onUpdate:modelValue":t[0]||(t[0]=e=>d.create_at=e)},null,512),[[u.Jo,d.create_at]])]),(0,l.Lk)("div",b,[t[6]||(t[6]=(0,l.Lk)("label",{for:"id"},"訂單編號",-1)),(0,l.bo)((0,l.Lk)("input",{type:"text",class:"form-control",id:"id","onUpdate:modelValue":t[1]||(t[1]=e=>d.tempOrder.id=e)},null,512),[[u.Jo,d.tempOrder.id]])]),(0,l.Lk)("div",f,[t[7]||(t[7]=(0,l.Lk)("label",{for:"message"},"訂單留言",-1)),(0,l.bo)((0,l.Lk)("textarea",{name:"",id:"message",class:"form-control","onUpdate:modelValue":t[2]||(t[2]=e=>d.tempOrder.message=e),cols:"30",role:"10"},null,512),[[u.Jo,d.tempOrder.message]])]),(0,l.Lk)("div",v,[(0,l.Lk)("div",O,[(0,l.bo)((0,l.Lk)("input",{class:"form-check-input",type:"checkbox","true-value":!0,"false-value":!1,"onUpdate:modelValue":t[3]||(t[3]=e=>d.tempOrder.is_paid=e),id:"is_paid"},null,512),[[u.lH,d.tempOrder.is_paid]]),t[8]||(t[8]=(0,l.Lk)("label",{class:"form-check-label",for:"is_paid"},"是否已付款",-1))])])]),(0,l.Lk)("div",_,[t[9]||(t[9]=(0,l.Lk)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close",-1)),(0,l.Lk)("button",{type:"button",class:"btn btn-primary",onClick:t[4]||(t[4]=t=>e.$emit("sendOrder",d.tempOrder))},"更新訂單")])])])],512)}var M=a(3286),y={name:"OrderModal",data(){return{tempOrder:{create_at:""},create_at:""}},props:["order"],emits:["sendOrder"],watch:{order(e,t){this.tempOrder=e;const a=new Date(1e3*this.tempOrder.create_at).toISOString().split("T");this.create_at=a[0]},create_at(){this.tempOrder.create_at=Math.floor(new Date(this.create_at)/1e3)}},mixins:[M.A]},$=a(1241);const x=(0,$.A)(y,[["render",C]]);var E=x,X=a(1716),P=a(8589),w={data(){return{orderList:[],pagination:{},isLoading:!1,tempOrder:{}}},components:{OrderModal:E,DelModal:X.A,PaginationModal:P.A},methods:{getOrderList(e=1){const t=`https://vue3-course-api.hexschool.io/api/caffeineshop/admin/orders?page=${e}`;this.isLoading=!0,this.$http.get(t).then(e=>{this.isLoading=!1,this.orderList=e.data.orders,this.pagination=e.data.pagination,console.log(this.orderList)}).catch(e=>{this.$InformMessage(e,"取得訂單列表")})},openOrderModal(e){this.tempOrder={...e},this.$refs.orderModal.showModal()},openDelModal(e){this.tempOrder={...e},this.$refs.delModal.showModal()},updateOrder(e){this.tempOrder=e,console.log(e);const t=`https://vue3-course-api.hexschool.io/api/caffeineshop/admin/order/${this.tempOrder.id}`;this.$http.put(t,{data:this.tempOrder}).then(e=>{this.$refs.orderModal.hideModal(),console.log(e),this.getOrderList(this.pagination.current_page)}).catch(e=>{this.$InformMessage(e,"訂單更新")})},delOrder(e){this.tempOrder=e;const t=`https://vue3-course-api.hexschool.io/api/caffeineshop/admin/order/${this.tempOrder.id}`;this.$http.delete(t,{data:this.tempOrder}).then(e=>{this.$InformMessage(e,"訂單刪除"),this.$refs.delModal.hideModal(),this.getOrderList()}).catch(e=>{this.$InformMessage(e,"訂單刪除")})}},created(){this.getOrderList()}};const D=(0,$.A)(w,[["render",p]]);var A=D},1716:function(e,t,a){a.d(t,{A:function(){return b}});var l=a(6768),s=a(4232);const d={class:"modal fade",id:"delModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},r={class:"modal-dialog",role:"document"},o={class:"modal-content border-0"},n={class:"modal-header bg-danger text-white"},i={class:"modal-title"},c={class:"modal-body"},p={class:"text-danger"},u={class:"modal-footer"};function m(e,t,a,m,h,k){return(0,l.uX)(),(0,l.CE)("div",d,[(0,l.Lk)("div",r,[(0,l.Lk)("div",o,[(0,l.Lk)("div",n,[(0,l.Lk)("h5",i,[(0,l.Lk)("span",null,"刪除 "+(0,s.v_)(a.item.title),1)]),t[1]||(t[1]=(0,l.Lk)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),(0,l.Lk)("div",c,[t[2]||(t[2]=(0,l.eW)("是否刪除",-1)),(0,l.Lk)("strong",p,(0,s.v_)(a.item.title),1),t[3]||(t[3]=(0,l.eW)(" (刪除後將無法恢復)。 ",-1))]),(0,l.Lk)("div",u,[t[4]||(t[4]=(0,l.Lk)("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"},"取消 ",-1)),(0,l.Lk)("button",{type:"button",class:"btn btn-danger",onClick:t[0]||(t[0]=t=>e.$emit("del-item",h.tempProduct))},"確認刪除")])])])],512)}var h=a(3286),k={name:"DelModal",props:{item:{type:Object,default(){return{}}}},data(){return{tempProduct:{}}},watch:{item(){this.tempProduct=this.item}},mixins:[h.A]},g=a(1241);const L=(0,g.A)(k,[["render",m]]);var b=L},8589:function(e,t,a){a.d(t,{A:function(){return v}});var l=a(6768),s=a(5130),d=a(4232);const r={class:"container"},o={class:"row"},n={class:"col-12"},i={"aria-label":"Page navigation example"},c={class:"pagination justify-content-center"},p={key:0,class:"page-item"},u={key:1,class:"page-item disabled"},m=["onClick"],h={key:2,class:"page-item"},k={key:3,class:"page-item disabled"};function g(e,t,a,g,L,b){return(0,l.uX)(),(0,l.CE)("div",r,[(0,l.Lk)("div",o,[(0,l.Lk)("div",n,[(0,l.Lk)("nav",i,[(0,l.Lk)("ul",c,[a.pages.has_pre?((0,l.uX)(),(0,l.CE)("li",p,[(0,l.Lk)("a",{class:"page-link",href:"#","aria-label":"Previous",onClick:t[0]||(t[0]=(0,s.D$)(e=>b.updatePage(a.pages.current_page-1),["prevent"]))},[...t[2]||(t[2]=[(0,l.Lk)("span",{"aria-hidden":"true"},"«",-1)])])])):((0,l.uX)(),(0,l.CE)("li",u,[...t[3]||(t[3]=[(0,l.Lk)("span",{class:"page-link","aria-hidden":"true"},"«",-1)])])),((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(a.pages.total_pages,e=>((0,l.uX)(),(0,l.CE)("li",{class:(0,d.C4)(["page-item",{active:e===a.pages.current_page}]),key:e},[(0,l.Lk)("a",{class:"page-link",href:"#",onClick:(0,s.D$)(t=>b.updatePage(e),["prevent"])},(0,d.v_)(e),9,m)],2))),128)),a.pages.has_next?((0,l.uX)(),(0,l.CE)("li",h,[(0,l.Lk)("a",{class:"page-link",href:"#","aria-label":"Next",onClick:t[1]||(t[1]=(0,s.D$)(e=>b.updatePage(a.pages.current_page+1),["prevent"]))},[...t[4]||(t[4]=[(0,l.Lk)("span",{"aria-hidden":"true"},"»",-1)])])])):((0,l.uX)(),(0,l.CE)("li",k,[...t[5]||(t[5]=[(0,l.Lk)("span",{class:"page-link","aria-hidden":"true"},"»",-1)])]))])])])])])}var L={name:"PaginationModal",props:["pages"],methods:{updatePage(e){window.scrollTo({top:0}),this.$emit("emit-page",e)}}},b=a(1241);const f=(0,b.A)(L,[["render",g]]);var v=f}}]);
//# sourceMappingURL=414.c60912c5.js.map