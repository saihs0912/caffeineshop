"use strict";(self["webpackChunkcaffeineshop"]=self["webpackChunkcaffeineshop"]||[]).push([[909],{8909:function(e,t,s){s.r(t),s.d(t,{default:function(){return Ue}});var a=s(6768);const l={class:"navbar navbar-expand-lg navbar-light bg-light p-4",style:{"max-width":"991px"}},n={class:"container"},r={class:"row"},o={class:"col-12"},c={class:"container mb-5",style:{"max-width":"991px"}},i={class:"row"},d={class:"col-12"},u={class:"d-flex mx-auto justify-content-center",style:{"max-width":"300px"}},m={key:0},p={key:1};function h(e,t,s,h,k,f){const b=(0,a.g2)("router-link"),C=(0,a.g2)("checkout-process");return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.Lk)("nav",l,[(0,a.Lk)("div",n,[(0,a.Lk)("div",r,[(0,a.Lk)("div",o,[(0,a.bF)(b,{to:"/",class:"navbar-brand"},{default:(0,a.k6)(()=>[...t[2]||(t[2]=[(0,a.Lk)("i",{class:"bi bi-box-arrow-left"},null,-1),(0,a.eW)(" 返回",-1)])]),_:1})])])])]),(0,a.Lk)("div",c,[(0,a.Lk)("div",i,[(0,a.Lk)("div",d,[(0,a.bF)(C,{step:k.currentStep},null,8,["step"]),((0,a.uX)(),(0,a.Wv)(a.PR,null,[((0,a.uX)(),(0,a.Wv)((0,a.$y)(f.currentStepComponent),{ref:"infoForm","send-form-final":k.form,"send-cart-final":k.cart,"send-order":k.orderId,onSendCart:f.getCart,onSendData:f.getForm},null,40,["send-form-final","send-cart-final","send-order","onSendCart","onSendData"]))],1024)),(0,a.Lk)("div",u,[k.pre?((0,a.uX)(),(0,a.CE)("button",{key:0,type:"button",class:"btn btn-outline-brown m-1 py-2 px-4 fs-4",onClick:t[0]||(t[0]=(...e)=>f.preStep&&f.preStep(...e))},"上一步")):(0,a.Q3)("",!0),k.currentStep!==k.totalSteps?((0,a.uX)(),(0,a.CE)("button",{key:1,type:"button",class:"btn btn-outline-brown m-1 py-2 px-4 fs-4",onClick:t[1]||(t[1]=(...e)=>f.nextStep&&f.nextStep(...e))},[3==k.currentStep?((0,a.uX)(),(0,a.CE)("span",m,"結帳")):((0,a.uX)(),(0,a.CE)("span",p,"下一步"))])):(0,a.Q3)("",!0)])])])])],64)}var k=s(4232);const f={class:"container"},b={class:"row justify-content-center"},C={class:"col-lg-9 col-md-9 col-sm-12 col-12"},v={class:"d-flex w-100 position-relative pt-4"},L={class:"w-25 text-center align-self-center"},g={key:0,class:"bi bi-check-circle bg-white fs-1 text-success"},y={key:1,class:"bi bi-circle-fill bg-white fs-4 text-success"},F={class:"w-25 text-center align-text-bottom align-self-center"},x={key:0,class:"bi bi-check-circle bg-white fs-1 text-success"},w={key:1,class:"bi bi-circle bg-white fs-4 text-secondary"},S={key:2,class:"bi bi-circle-fill bg-white fs-4 text-success"},E={class:"w-25 text-center align-self-center"},_={key:0,class:"bi bi-check-circle bg-white fs-1 text-success"},X={key:1,class:"bi bi-circle bg-white fs-4 text-secondary"},$={key:2,class:"bi bi-circle-fill bg-white fs-4 text-success"},I={class:"w-25 text-center align-self-center"},O={key:0,class:"bi bi-check-circle bg-white fs-1 text-success"},V={key:1,class:"bi bi-circle bg-white fs-4 text-secondary"},j={class:"d-flex w-100"};function A(e,t,s,l,n,r){return(0,a.uX)(),(0,a.CE)("div",f,[(0,a.Lk)("div",b,[(0,a.Lk)("div",C,[(0,a.Lk)("div",v,[t[0]||(t[0]=(0,a.Lk)("span",{class:"processline position-absolute d-block"},null,-1)),(0,a.Lk)("span",{class:"processlineDone position-absolute d-block",style:(0,k.Tr)(n.widthObj)},null,4),(0,a.Lk)("div",L,[1===s.step?((0,a.uX)(),(0,a.CE)("i",g)):s.step>1?((0,a.uX)(),(0,a.CE)("i",y)):(0,a.Q3)("",!0)]),(0,a.Lk)("div",F,[2===s.step?((0,a.uX)(),(0,a.CE)("i",x)):s.step<2?((0,a.uX)(),(0,a.CE)("i",w)):((0,a.uX)(),(0,a.CE)("i",S))]),(0,a.Lk)("div",E,[3===s.step?((0,a.uX)(),(0,a.CE)("i",_)):s.step<3?((0,a.uX)(),(0,a.CE)("i",X)):((0,a.uX)(),(0,a.CE)("i",$))]),(0,a.Lk)("div",I,[4===s.step?((0,a.uX)(),(0,a.CE)("i",O)):s.step<4?((0,a.uX)(),(0,a.CE)("i",V)):(0,a.Q3)("",!0)])]),(0,a.Lk)("div",j,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(n.stepName,(e,t)=>((0,a.uX)(),(0,a.CE)("div",{key:"step"+t,class:(0,k.C4)(["w-25 text-secondary text-center",[s.step==t+1?"fw-bolder":""]])},(0,k.v_)(e),3))),128))])])])])}var T={name:"CheckoutProcess",data(){return{widthObj:{width:""},stepName:["訂購資訊","顧客資訊","最終確認","訂購完成"]}},props:["step"],watch:{step(e,t){this.widthObj.width=`calc( 75% * ((${e} - 1) / 3))`}}},U=s(1241);const D=(0,U.A)(T,[["render",A]]);var Q=D,q=s(5130);const K={class:"mb-5 mt-5"},P={class:"table align-middle"},M={style:{width:"60px"}},N=["src"],W={"data-item":"商品"},J={"data-item":"價格"},Z={"data-item":"數量"},z=["onUpdate:modelValue","onChange","disabled"],R={"data-item":"清除"},B=["onClick"],G={class:"container mb-4"},H={class:"row"},Y={class:"col-lg-6 col-md-6 col-sm-8 col-12 mb-5"},ee={class:"input-group mb-3 mt-3"},te={key:0,class:"text-success fs-6"},se={class:"col-lg-6 col-md-6 col-sm-8 col-12 mb-5"},ae={key:0,class:"d-block fs-4 text-success mt-3"};function le(e,t,s,l,n,r){return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.Lk)("div",K,[t[3]||(t[3]=(0,a.Lk)("p",{class:"text-center fw-bolder fs-3"},"請確認商品與金額",-1)),(0,a.Lk)("table",P,[t[2]||(t[2]=(0,a.Lk)("thead",null,[(0,a.Lk)("tr",null,[(0,a.Lk)("th"),(0,a.Lk)("th",null,"商品"),(0,a.Lk)("th",null,"價格"),(0,a.Lk)("th",{style:{width:"90px"}},"數量"),(0,a.Lk)("th",null,"清除")])],-1)),(0,a.Lk)("tbody",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(n.cart.carts,(t,s)=>((0,a.uX)(),(0,a.CE)("tr",{key:s},[(0,a.Lk)("td",null,[(0,a.Lk)("div",M,[(0,a.Lk)("img",{src:n.cart.carts[s].product.imageUrl,alt:"",class:"img-fluid"},null,8,N)])]),(0,a.Lk)("td",W,(0,k.v_)(t.product.title),1),(0,a.Lk)("td",J,(0,k.v_)(e.$num.currency(t.final_total)),1),(0,a.Lk)("td",Z,[(0,a.bo)((0,a.Lk)("input",{type:"number",class:"form-control","onUpdate:modelValue":e=>t.qty=e,min:"1",onChange:e=>r.updateCart(t),disabled:t.id===n.status.loadingItem},null,40,z),[[q.Jo,t.qty,void 0,{number:!0}]])]),(0,a.Lk)("td",R,[(0,a.Lk)("button",{type:"button",class:"btn btn-outline-danger btn-sm del",onClick:e=>r.deleteCartItem(t.id)},null,8,B)])]))),128))])])]),t[7]||(t[7]=(0,a.Lk)("hr",null,null,-1)),(0,a.Lk)("div",G,[(0,a.Lk)("div",H,[(0,a.Lk)("div",Y,[t[4]||(t[4]=(0,a.Lk)("span",{class:"fs-4"},"套用優惠券",-1)),t[5]||(t[5]=(0,a.eW)()),t[6]||(t[6]=(0,a.Lk)("span",{class:"fs-6 text-danger"},"※ 一次限套用一張",-1)),(0,a.Lk)("div",ee,[(0,a.Lk)("button",{class:"btn btn-outline-secondary",type:"button",id:"button-addon1",onClick:t[0]||(t[0]=(...e)=>r.addCouponCode&&r.addCouponCode(...e))},"套用"),(0,a.bo)((0,a.Lk)("input",{type:"text",class:"form-control",placeholder:"輸入優惠代碼","aria-label":"Example text with button addon","aria-describedby":"button-addon1","onUpdate:modelValue":t[1]||(t[1]=e=>n.coupon_code=e)},null,512),[[q.Jo,n.coupon_code]])]),n.cart.final_total<n.cart.total?((0,a.uX)(),(0,a.CE)("span",te,"※ 已套用優惠券")):(0,a.Q3)("",!0)]),(0,a.Lk)("div",se,[(0,a.Lk)("div",{class:(0,k.C4)(["d-block fs-4",{"text-decoration-line-through":n.cart.final_total<n.cart.total}])},"總金額："+(0,k.v_)(n.cart.total),3),n.cart.final_total<n.cart.total?((0,a.uX)(),(0,a.CE)("div",ae,"折扣價："+(0,k.v_)(e.$num.currency(n.cart.final_total)),1)):(0,a.Q3)("",!0)])])])],64)}var ne={name:"CheckTotal",data(){return{cart:{},coupon_code:"",status:{loadingItem:""}}},emits:["sendData","sendCart","sendTry"],props:{sendFormFinal:{type:Object,default(){return{}}},sendCartFinal:{type:Object,default(){return{}}},sendOrder:{type:String}},methods:{getCart(){const e="https://vue3-course-api.hexschool.io/api/caffeineshop/cart";this.$http.get(e).then(e=>{this.cart=e.data.data;const t=this.cart;this.$emit("sendCart",t)}).catch(e=>{this.$InformMessage(e,"取得購物車內容")})},updateCart(e){this.status.loadingItem=e.id;const t=`https://vue3-course-api.hexschool.io/api/caffeineshop/cart/${e.id}`,s={product_id:e.product_id,qty:e.qty};this.$http.put(t,{data:s}).then(e=>{this.status.loadingItem="",this.getCart()}).catch(e=>{this.status.loadingItem="",this.$InformMessage(e,"更新購物車內容")})},deleteCartItem(e){this.status.loadingItem=e;const t=`https://vue3-course-api.hexschool.io/api/caffeineshop/cart/${e}`;this.$http.delete(t,{data:e}).then(e=>{this.status.loadingItem="",this.getCart()}).catch(e=>{this.status.loadingItem="",this.$InformMessage(e,"刪除購物車內容")})},addCouponCode(){const e="https://vue3-course-api.hexschool.io/api/caffeineshop/coupon";this.usedCoupon_code=this.coupon_code,this.coupon_code="";const t={code:this.usedCoupon_code};this.$http.post(e,{data:t}).then(e=>{this.getCart()}).catch(e=>{this.$InformMessage(e,"添加優惠券")})},validateForm(){}},created(){this.getCart()}};const re=(0,U.A)(ne,[["render",le]]);var oe=re;const ce={class:"mb-5 mt-5"},ie={class:"my-5 justify-content-center"},de={class:"md-3 mb-3"},ue={class:"md-3 mb-3"},me={class:"md-3 mb-3"},pe={class:"md-3 mb-3"},he={class:"md-3 mb-3"};function ke(e,t,s,l,n,r){const o=(0,a.g2)("v-field"),c=(0,a.g2)("error-message"),i=(0,a.g2)("v-form");return(0,a.uX)(),(0,a.CE)("div",ce,[t[11]||(t[11]=(0,a.Lk)("p",{class:"text-center fw-bolder fs-3"},"請輸入購買者資料",-1)),(0,a.Lk)("div",ie,[(0,a.bF)(i,{class:"col-md-6 mx-auto",ref:"infoForm"},{default:(0,a.k6)(({errors:e})=>[(0,a.Lk)("div",de,[t[6]||(t[6]=(0,a.Lk)("label",{for:"email",class:"form-label"},"Email",-1)),(0,a.bF)(o,{id:"email",name:"email",type:"email",class:(0,k.C4)(["form-control",{"is-invalid":e["email"]}]),placeholder:"請輸入 Email",rules:"email|required",modelValue:n.form.user.email,"onUpdate:modelValue":t[0]||(t[0]=e=>n.form.user.email=e),onChange:r.formSend},null,8,["class","modelValue","onChange"]),(0,a.bF)(c,{name:"email",class:"invalid-feedback"})]),(0,a.Lk)("div",ue,[t[7]||(t[7]=(0,a.Lk)("label",{for:"name",class:"form-label"},"姓名",-1)),(0,a.bF)(o,{id:"name",name:"name",type:"text",class:(0,k.C4)(["form-control",{"is-invalid":e["name"]}]),placeholder:"請輸入姓名",rules:r.isName,modelValue:n.form.user.name,"onUpdate:modelValue":t[1]||(t[1]=e=>n.form.user.name=e),onChange:r.formSend},null,8,["class","rules","modelValue","onChange"]),(0,a.bF)(c,{name:"name",class:"invalid-feedback"})]),(0,a.Lk)("div",me,[t[8]||(t[8]=(0,a.Lk)("label",{for:"tel",class:"form-label"},"收件人電話",-1)),(0,a.bF)(o,{id:"tel",name:"tel",type:"tel",class:(0,k.C4)(["form-control",{"is-invalid":e["tel"]}]),placeholder:"請輸入電話",rules:r.isPhone,modelValue:n.form.user.tel,"onUpdate:modelValue":t[2]||(t[2]=e=>n.form.user.tel=e),onChange:r.formSend},null,8,["class","rules","modelValue","onChange"]),(0,a.bF)(c,{name:"tel",class:"invalid-feedback"})]),(0,a.Lk)("div",pe,[t[9]||(t[9]=(0,a.Lk)("label",{for:"address",class:"form-label"},"收件人地址",-1)),(0,a.bF)(o,{id:"address",name:"address",type:"text",class:(0,k.C4)(["form-control",{"is-invalid":e["address"]}]),placeholder:"請輸入地址",rules:r.isAddress,modelValue:n.form.user.address,"onUpdate:modelValue":t[3]||(t[3]=e=>n.form.user.address=e),onChange:r.formSend},null,8,["class","rules","modelValue","onChange"]),(0,a.bF)(c,{name:"address",class:"invalid-feedback"})]),(0,a.Lk)("div",he,[t[10]||(t[10]=(0,a.Lk)("label",{for:"message",class:"form-label"},"留言",-1)),(0,a.bo)((0,a.Lk)("textarea",{name:"",id:"message",class:"form-control","onUpdate:modelValue":t[4]||(t[4]=e=>n.form.message=e),cols:"30",role:"10",onChange:t[5]||(t[5]=(...e)=>r.formSend&&r.formSend(...e))},null,544),[[q.Jo,n.form.message]])])]),_:1},512)])])}var fe={name:"CheckCustomer",data(){return{form:{user:{name:"",email:"",tel:"",address:""},message:""}}},emits:["sendData","sendCart"],props:{sendFormFinal:{type:Object,default(){return{}}},sendCartFinal:{type:Object,default(){return{}}},sendOrder:{type:String}},methods:{isName(e){const t=/^[\u4e00-\u9fa5]+$|^[A-Z][a-zA-Z\s-]+$/;return!!t.test(e)||"請輸入正確的姓名"},isPhone(e){const t=/^(09)[0-9]{8}$/;return!!t.test(e)||"請輸入正確的電話號碼"},isAddress(e){return!!e||"請輸入地址"},async validateForm(){const{valid:e}=await this.$refs.infoForm.validate();return e},formSend(){const e=this.form;this.$emit("sendData",e)}},mounted(){this.safeForm&&(this.form={...this.safeForm})}};const be=(0,U.A)(fe,[["render",ke]]);var Ce=be;const ve={class:"mb-5 mt-5"},Le={class:"pb-5"},ge={class:"table"},ye={key:0},Fe={class:"table"},xe={class:"fs-2"},we={key:0,class:"text-success"};function Se(e,t,s,l,n,r){return(0,a.uX)(),(0,a.CE)("div",ve,[t[6]||(t[6]=(0,a.Lk)("p",{class:"text-center fw-bolder fs-3"},"請確認您的個人資料以及訂單內容",-1)),(0,a.Lk)("div",Le,[(0,a.Lk)("table",ge,[(0,a.Lk)("tbody",null,[(0,a.Lk)("tr",null,[t[0]||(t[0]=(0,a.Lk)("td",null,"姓名：",-1)),(0,a.Lk)("td",null,(0,k.v_)(s.sendFormFinal.user.name),1)]),(0,a.Lk)("tr",null,[t[1]||(t[1]=(0,a.Lk)("td",null,"Email：",-1)),(0,a.Lk)("td",null,(0,k.v_)(s.sendFormFinal.user.email),1)]),(0,a.Lk)("tr",null,[t[2]||(t[2]=(0,a.Lk)("td",null,"地址：",-1)),(0,a.Lk)("td",null,(0,k.v_)(s.sendFormFinal.user.address),1)]),(0,a.Lk)("tr",null,[t[3]||(t[3]=(0,a.Lk)("td",null,"電話：",-1)),(0,a.Lk)("td",null,(0,k.v_)(s.sendFormFinal.user.tel),1)]),s.sendFormFinal.message?((0,a.uX)(),(0,a.CE)("tr",ye,[t[4]||(t[4]=(0,a.Lk)("td",null,"留言：",-1)),(0,a.Lk)("td",null,(0,k.v_)(s.sendFormFinal.message),1)])):(0,a.Q3)("",!0)])])]),(0,a.Lk)("div",null,[(0,a.Lk)("table",Fe,[t[5]||(t[5]=(0,a.Lk)("thead",null,[(0,a.Lk)("tr",null,[(0,a.Lk)("th",null,"商品名稱"),(0,a.Lk)("th",null,"數量"),(0,a.Lk)("th",null,"總金額")])],-1)),(0,a.Lk)("tbody",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(s.sendCartFinal.carts,(e,t)=>((0,a.uX)(),(0,a.CE)("tr",{key:t},[(0,a.Lk)("td",null,(0,k.v_)(e.product.title),1),(0,a.Lk)("td",null,(0,k.v_)(e.qty),1),(0,a.Lk)("td",null,(0,k.v_)(e.final_total),1)]))),128))])])]),(0,a.Lk)("div",null,[(0,a.Lk)("p",xe,"總金額："+(0,k.v_)(e.$num.currency(s.sendCartFinal.final_total)),1),s.sendCartFinal.final_total<s.sendCartFinal.total?((0,a.uX)(),(0,a.CE)("p",we,"已套用優惠券")):(0,a.Q3)("",!0)])])}var Ee={name:"CheckFinal",data(){return{cart:{}}},emits:["sendData","sendCart"],props:{sendFormFinal:{type:Object,default(){return{}}},sendCartFinal:{type:Object,default(){return{}}},sendOrder:{type:String}},methods:{validateForm(){}}};const _e=(0,U.A)(Ee,[["render",Se]]);var Xe=_e;const $e={class:"d-flex mx-auto justify-content-center"};function Ie(e,t,s,l,n,r){return(0,a.uX)(),(0,a.CE)(a.FK,null,[t[3]||(t[3]=(0,a.Lk)("div",{class:"mb-1 mt-5"},[(0,a.Lk)("p",{class:"text-center fw-bolder fs-3 mb-5"},"感謝您的購買！"),(0,a.Lk)("p",{class:"text-center fs-5"},"接下來您可以...")],-1)),(0,a.Lk)("div",$e,[(0,a.Lk)("button",{type:"button",class:"btn btn-outline-brown m-1 py-2 px-4 fs-4",onClick:t[0]||(t[0]=e=>r.goTo(s.sendOrder))},"查看訂單"),(0,a.Lk)("button",{type:"button",class:"btn btn-outline-brown m-1 py-2 px-4 fs-4",onClick:t[1]||(t[1]=e=>r.goTo("/shopping"))},"回到商場"),(0,a.Lk)("button",{type:"button",class:"btn btn-outline-brown m-1 py-2 px-4 fs-4",onClick:t[2]||(t[2]=e=>r.goTo("/"))},"回到首頁")])],64)}s(4114);var Oe={name:"CheckOver",emits:["sendData","sendCart"],props:{sendFormFinal:{type:Object,default(){return{}}},sendCartFinal:{type:Object,default(){return{}}},sendOrder:{type:String}},methods:{validateForm(){},goTo(e){console.log(e),"/"===e?this.$router.push("/"):"/shopping"===e?this.$router.push("/shopping"):this.$router.push({name:"order",query:{orderId:e}})}}};const Ve=(0,U.A)(Oe,[["render",Ie]]);var je=Ve,Ae={name:"CheckPage",data(){return{currentStep:1,totalSteps:4,pre:!1,next:!0,cart:{},tempCart:{},form:{},cartAndForm:{},orderId:""}},components:{CheckoutProcess:Q,CheckTotal:oe,CheckCustomer:Ce,CheckFinal:Xe,CheckOver:je},props:["sendForm"],methods:{async nextStep(){if(this.$refs.infoForm.validateForm()){const e=await this.$refs.infoForm.validateForm();if(console.log(e),!e)return}this.currentStep<this.totalSteps&&this.currentStep++,4===this.currentStep&&this.createOrder(),1===this.currentStep||4===this.currentStep?this.pre=!1:this.pre=!0},preStep(){this.currentStep>1&&this.currentStep--,1===this.currentStep&&(this.pre=!1)},getCart(e){this.cart=e},getForm(e){this.form=e},createOrder(){const e="https://vue3-course-api.hexschool.io/api/caffeineshop/order",t=this.form;this.$http.post(e,{data:t}).then(e=>{this.orderId=e.data.orderId}).catch(e=>{this.$InformMessage(e,"送出訂單")})}},computed:{currentStepComponent(){return["CheckTotal","CheckCustomer","CheckFinal","CheckOver"][this.currentStep-1]}}};const Te=(0,U.A)(Ae,[["render",h]]);var Ue=Te}}]);
//# sourceMappingURL=909.834c6012.js.map