"use strict";(self["webpackChunkcaffeineshop"]=self["webpackChunkcaffeineshop"]||[]).push([[174],{174:function(t,s,o){o.r(s),o.d(s,{default:function(){return w}});var e=o(6768),i=o(5130),a=o(6409);const n={class:"bg"},r={class:"container"},c={class:"col-md-4 loginBox"},h={class:"form-group"},u={class:"mb-2"},d={class:"mb-2"};function p(t,s,o,p,l,f){const m=(0,e.g2)("toast-messages");return(0,e.uX)(),(0,e.CE)(e.FK,null,[(0,e.Lk)("div",n,[(0,e.Lk)("div",r,[(0,e.Lk)("form",{class:"row justify-content-center",onSubmit:s[2]||(s[2]=(0,i.D$)((...t)=>f.signIn&&f.signIn(...t),["prevent"]))},[(0,e.Lk)("div",c,[s[6]||(s[6]=(0,e.Lk)("div",{style:{width:"60px",margin:"0 auto"}},[(0,e.Lk)("img",{src:a,width:"80",alt:""})],-1)),s[7]||(s[7]=(0,e.Lk)("h3",{style:{"text-align":"center"}},"後台管理系統",-1)),(0,e.Lk)("div",h,[(0,e.Lk)("div",u,[s[3]||(s[3]=(0,e.Lk)("label",{for:"inputEmail",class:"sr-only"},"請輸入Email",-1)),(0,e.bo)((0,e.Lk)("input",{type:"email",id:"inputEmail",name:"userEmail",placeholder:"請輸入Email",class:"form-control","onUpdate:modelValue":s[0]||(s[0]=t=>l.user.username=t)},null,512),[[i.Jo,l.user.username]])]),(0,e.Lk)("div",d,[s[4]||(s[4]=(0,e.Lk)("label",{for:"inputPassword",class:"sr-only"},"請輸入密碼",-1)),(0,e.bo)((0,e.Lk)("input",{type:"password",id:"inputPassword",name:"userPass",placeholder:"請輸入密碼",class:"form-control","onUpdate:modelValue":s[1]||(s[1]=t=>l.user.password=t),autocomplete:"new-password"},null,512),[[i.Jo,l.user.password]])]),s[5]||(s[5]=(0,e.Lk)("div",{class:"text-end mt-4"},[(0,e.Lk)("button",{class:"btn btn-lg btn-primary btn-block",type:"submit"},"登入")],-1))])])],32)])]),(0,e.bF)(m)],64)}var l=o(1600),f=o(5306),m=o(920),g={head(){return{title:"登入"}},data(){return{user:{username:"",password:""}}},components:{ToastMessages:m.A},provide(){return{emitter:l.A}},methods:{signIn:f.Jv}},$=o(1241);const y=(0,$.A)(g,[["render",p]]);var w=y},920:function(t,s,o){o.d(s,{A:function(){return w}});var e=o(6768);const i={class:"toast-container position-fixed bottom-0 start-0 p-3",style:{"z-index":"1050"}};function a(t,s,o,a,n,r){const c=(0,e.g2)("toast-modal");return(0,e.uX)(),(0,e.CE)("div",i,[((0,e.uX)(!0),(0,e.CE)(e.FK,null,(0,e.pI)(n.messages,(t,s)=>((0,e.uX)(),(0,e.Wv)(c,{key:s,msg:t},null,8,["msg"]))),128))])}o(4114);var n=o(4232);const r={class:"toast",role:"alert","aria-live":"assertive","aria-atomic":"true",ref:"toast"},c={class:"toast-header"},h={class:"me-auto"},u={key:0,class:"toast-body"};function d(t,s,o,i,a,d){return(0,e.uX)(),(0,e.CE)("div",r,[(0,e.Lk)("div",c,[(0,e.Lk)("span",{class:(0,n.C4)([`bg-${o.msg.style}`,"p-2 rounded me-2 d-inline-block"])},null,2),(0,e.Lk)("strong",h,(0,n.v_)(o.msg.title),1),s[0]||(s[0]=(0,e.Lk)("button",{type:"button",class:"btn-close","data-bs-dismiss":"toast","aria-label":"Close"},null,-1))]),o.msg.content?((0,e.uX)(),(0,e.CE)("div",u,(0,n.v_)(o.msg.content),1)):(0,e.Q3)("",!0)],512)}var p=o(8077),l={name:"ToastModal",props:["msg"],mounted(){const t=this.$refs.toast,s=new p.y8(t,{delay:6e3});s.show()}},f=o(1241);const m=(0,f.A)(l,[["render",d]]);var g=m,$={name:"ToastMessages",components:{ToastModal:g},data(){return{messages:[]}},inject:["emitter"],mounted(){this.emitter.on("push-message",t=>{const{style:s="success",title:o,content:e}=t;this.messages.push({style:s,title:o,content:e})})}};const y=(0,f.A)($,[["render",a]]);var w=y},5306:function(t,s,o){o.d(s,{AS:function(){return i},Ap:function(){return I},FD:function(){return h},GW:function(){return l},Jj:function(){return u},Jv:function(){return m},QM:function(){return y},Xl:function(){return n},_t:function(){return x},b$:function(){return f},bE:function(){return r},c5:function(){return w},c8:function(){return M},e0:function(){return g},fS:function(){return d},iH:function(){return c},iY:function(){return k},k3:function(){return $},mx:function(){return v},n7:function(){return L},oo:function(){return a},r$:function(){return p}});o(4114),o(8111),o(7588);var e=o(1600);async function i(t){const s="https://vue3-course-api.hexschool.io/api/caffeineshop/products/all";try{const o=await t.get(s);return o.data.products}catch(o){const t=new Error("取得產品列表");t.original=t}}async function a(t,s){try{const o=`https://vue3-course-api.hexschool.io/api/caffeineshop/product/${s}`,e=await t.get(o);return e}catch(o){throw new Error("無法取得商品")}}async function n(t){const s="https://vue3-course-api.hexschool.io/api/caffeineshop/cart";try{const o=await this.$http.get(s),e=o.data.data;if(this.cart=e,this.cart.carts[0]?.coupon?.code&&(this.usedCoupon=this.cart.carts[0].coupon.code),this.num=e.carts.length,"check"===t)this.$emit("sendCart",this.cart);else if("cart"===t)return this.$emit("updateNum",this.num),this.cart.carts.length}catch(o){console.log(o),this.$InformMessage(o,"取得購物車資訊"),"cart"===t&&(this.err=!0)}}async function r(t,s,o,i,a){const n="https://vue3-course-api.hexschool.io/api/caffeineshop/cart";"detail"===i&&this.cartPutIn&&(this.cartPutIn=!this.cartPutIn),"list"===i&&(this.status.loadingItem=s);const r={product_id:s,qty:o};try{const s=await t.post(n,{data:r});if(console.log(s),"list"===i?this.cart=a:"detail"===i&&(this.cartPutIn=!0),"follow"!==i&&"cart"!==i)this.status.loadingItem="",this.$InformMessage(s,"商品放入購物車");else if("follow"===i||"cart"===i)return s;e.A.emit("updateCart")}catch(c){if("follow"!==i)this.status.loadingItem="",this.$InformMessage(c,"商品放入購物車");else if("follow"===i){const t=new Error("商品放入購物車");throw t.original=t,t}}}async function c(t,s){try{this.status.loadingItem=t.id;const o=`https://vue3-course-api.hexschool.io/api/caffeineshop/cart/${t.id}`,e={product_id:t.product_id,qty:t.qty};await this.$http.put(o,{data:e}),this.status.loadingItem="",this.getCart(s)}catch(o){this.status.loadingItem="",this.$InformMessage(o,"購物車更新")}}async function h(t,s){try{this.status.loadingItem=t;const o=`https://vue3-course-api.hexschool.io/api/caffeineshop/cart/${t}`;await this.$http.delete(o,{data:t}),this.status.loadingItem="",this.getCart(s)}catch(o){this.status.loadingItem="",this.$InformMessage(o,"商品刪除")}}async function u(t,s){try{const o="https://vue3-course-api.hexschool.io/api/caffeineshop/coupon",e={code:t},i=await s.post(o,{data:e});return i}catch(o){throw new Error(o)}}async function d(){const t="https://vue3-course-api.hexschool.io/api/caffeineshop/order",s=this.form;try{const o=await this.$http.post(t,{data:s});this.orderId=o.data.orderId}catch(o){this.$InformMessage(o,"送出訂單")}}async function p(t,s){this.isLoading=!0,"orderlist"===s&&(this.pageShow=!1,this.searchResult=[],this.notFound=!1,this.connectError=!1);const o=`https://vue3-course-api.hexschool.io/api/caffeineshop/order/${t}`;try{const t=await this.$http.get(o);this.isLoading=!1,"orderlist"===s?null!==t.data.order?this.searchResult.push(t.data.order):this.notFound=!0:"orderdetail"===s&&(this.order=t.data.order,this.user=t.data.order.user,Object.values(this.order.products).forEach((t,s)=>{this.total+=t.total}))}catch(e){this.isLoading=!1,this.notFound=!0}}async function l(t=1){this.pageShow=!0,this.isLoading=!0,!0===this.notFound&&(this.notFound=!1);const s=`https://vue3-course-api.hexschool.io/api/caffeineshop/orders?page=${t}`;try{const t=await this.$http.get(s);this.isLoading=!1,t.data.success&&(this.searchResult=t.data.orders,this.pagination=t.data.pagination)}catch(o){this.isLoading=!1,this.$InformMessage(o,"取得訂單列表")}}async function f(t,s){const o=`https://vue3-course-api.hexschool.io/api/caffeineshop/pay/${t}`;try{await s.post(o)}catch(e){throw new Error(e,"付款")}}async function m(){const t="https://vue3-course-api.hexschool.io/admin/signin";try{const s=await this.$http.post(t,this.user);if(s.data.success){const{token:t,expired:o}=s.data;this.$InformMessage(s,"登入"),document.cookie=`makotoToken=${t}; expires=${o}`,setTimeout(()=>{this.$router.push("/dashboard/productlist")},3e3)}}catch(s){this.$InformMessage(s,"登入")}}async function g(t=1){const s=`https://vue3-course-api.hexschool.io/api/caffeineshop/admin/products/?page=${t}`;this.isLoading=!0;try{const t=await this.$http.get(s);this.isLoading=!1,t.data.success&&(this.products=t.data.products,this.pagination=t.data.pagination)}catch(o){this.$InformMessage(o,"取得頁面資訊")}}async function $(t){this.tempProduct=t;let s="https://vue3-course-api.hexschool.io/api/caffeineshop/admin/product",o="post";this.isNew||(s=`${s}/${t.id}`,o="put");try{const t=await this.$http[o](s,{data:this.tempProduct});t.data.success&&("post"===o?this.$InformMessage(t,"商品新增"):this.$InformMessage(t,"商品更新"),this.getProducts(this.pagination.current_page)),this.$refs.productModal.hideModal()}catch(e){this.$InformMessage(e,"商品更新")}}async function y(t){try{const s=this.$refs[t].files[0],o=new FormData;o.append("file-to-upload",s);const e="https://vue3-course-api.hexschool.io/api/caffeineshop/admin/upload",i=await this.$http.post(e,o);i.data.success&&("fileInput"===t?this.tempProduct.imageUrl=i.data.imageUrl:this.tempProduct.imagesUrl.push(i.data.imageUrl))}catch(s){this.$InformMessage(s,"圖片上傳")}}async function w(t){this.tempProduct=t;const s=`https://vue3-course-api.hexschool.io/api/caffeineshop/admin/product/${t.id}`;try{const o=await this.$http.delete(s,{data:this.tempProduct});this.$InformMessage(o,`商品${t.title}刪除`),this.getProducts()}catch(o){this.$InformMessage(o,"商品刪除")}this.$refs.delModal.hideModal()}async function v(t=1){try{this.isLoading=!0;const s=`https://vue3-course-api.hexschool.io/api/caffeineshop/admin/coupons?page=${t}`,o=await this.$http.get(s);console.log(o),this.coupons=o.data.coupons,this.pagination=o.data.pagination,this.isLoading=!1}catch(s){this.isLoading=!1,this.$InformMessage(s,"取得優惠券列表")}}async function M(t){try{this.tempCoupon=t;let s="https://vue3-course-api.hexschool.io/api/caffeineshop/admin/coupon",o="post";this.isNew||(s=`${s}/${t.id}`,o="put");const e=await this.$http[o](s,{data:this.tempCoupon});"post"===o?this.$InformMessage(e,"優惠券新增"):this.$InformMessage(e,"優惠券更新"),this.$refs.couponModal.hideModal(),this.getCoupons(this.pagination.current_page)}catch(s){this.$refs.couponModal.hideModal(),this.$InformMessage(s,"更新優惠券")}}async function I(t){try{this.tempCoupon=t;const s=`https://vue3-course-api.hexschool.io/api/caffeineshop/admin/coupon/${this.tempCoupon.id}`,o=await this.$http.delete(s,{data:this.tempCoupon});this.$InformMessage(o,`優惠券${t.title}刪除`),this.$refs.delModal.hideModal(),this.getCoupons()}catch(s){this.$refs.delModal.hideModal(),this.$InformMessage(s,"優惠券刪除")}}async function L(t=1){const s=`https://vue3-course-api.hexschool.io/api/caffeineshop/admin/orders?page=${t}`;this.isLoading=!0;try{const t=await this.$http.get(s);this.isLoading=!1,this.orderList=t.data.orders,this.pagination=t.data.pagination}catch(o){this.$InformMessage(o,"取得訂單列表")}}async function k(t){this.tempOrder=t;const s=`https://vue3-course-api.hexschool.io/api/caffeineshop/admin/order/${this.tempOrder.id}`;try{await this.$http.put(s,{data:this.tempOrder}),this.$refs.orderModal.hideModal(),this.num=0,this.getOrderList(this.pagination.current_page)}catch(o){this.$InformMessage(o,"訂單更新")}}async function x(t){this.tempOrder=t;const s=`https://vue3-course-api.hexschool.io/api/caffeineshop/admin/order/${this.tempOrder.id}`;try{const t=await this.$http.delete(s,{data:this.tempOrder});this.$InformMessage(t,"訂單刪除"),this.$refs.delModal.hideModal(),this.getOrderList()}catch(o){this.$InformMessage(o,"訂單刪除")}}},6409:function(t,s,o){t.exports=o.p+"img/logo-1.3d9ac528.png"}}]);
//# sourceMappingURL=174.ca448d8a.js.map