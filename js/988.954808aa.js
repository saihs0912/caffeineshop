"use strict";(self["webpackChunkcaffeineshop"]=self["webpackChunkcaffeineshop"]||[]).push([[988],{4988:function(e,t,a){a.r(t),a.d(t,{default:function(){return Z}});var s=a(6768),l=a(5130);const n={class:"container"},r={class:"row"},o={class:"col-12"},i={class:"mt-4 mb-4"},d={class:"container"},c={class:"row justify-content-center"},u={class:"col-lg-9 col-md-10 col-sm-12 col-12 mt-3 mb-3"},h={class:"input-group h-100"},p={class:"col-lg-9 col-md-10 col-sm-12 col-12 pt-3 pb-5"};function k(e,t,a,k,g,L){const b=(0,s.g2)("router-link"),m=(0,s.g2)("order-show");return(0,s.uX)(),(0,s.CE)("div",n,[(0,s.Lk)("div",r,[(0,s.Lk)("div",o,[(0,s.Lk)("div",i,[(0,s.bF)(b,{to:"/",style:{"text-decoration":"none"}},{default:(0,s.k6)(()=>[...t[3]||(t[3]=[(0,s.eW)("首頁",-1)])]),_:1}),t[4]||(t[4]=(0,s.eW)(" > ",-1)),t[5]||(t[5]=(0,s.Lk)("span",null,"訂單查詢",-1))]),t[6]||(t[6]=(0,s.Lk)("h1",null,"訂單查詢",-1)),(0,s.Lk)("div",d,[(0,s.Lk)("div",c,[(0,s.Lk)("div",u,[(0,s.Lk)("div",h,[(0,s.Lk)("button",{class:"btn btn-outline-secondary",type:"button",id:"button-addon1",onClick:t[0]||(t[0]=(...e)=>L.searchOrder&&L.searchOrder(...e))},"以訂單編號搜尋"),(0,s.bo)((0,s.Lk)("input",{type:"text",class:"form-control","aria-label":"Sizing example input","aria-describedby":"inputGroup-sizing-default","onUpdate:modelValue":t[1]||(t[1]=e=>g.searchId=e)},null,512),[[l.Jo,g.searchId]]),(0,s.Lk)("button",{class:"btn btn-outline-secondary",type:"button",id:"button-addon1",onClick:t[2]||(t[2]=(...e)=>L.resetSearch&&L.resetSearch(...e))},"重置搜尋")])]),(0,s.Lk)("div",p,[(0,s.bF)(m,{sendOrder:g.searchResult},null,8,["sendOrder"])])])])])])])}var g=a(4232);const L={key:0,class:"text-center fw-bold fs-3 pt-4 pb-4"},b={key:1,class:"text-center fw-bold fs-3 pt-4 pb-4"},m={class:"card"},f=["onClick"],v={class:"container"},y={class:"row"},w={class:"col-6"},C={class:"col-6 fs-6 text-end"},x={class:"table"},P={style:{width:"50px"}},$=["src"],_={class:"table"},E={class:"card-footer"},I={class:"container"},X={class:"row"},O={class:"col-6"},F={class:"card-text fw-bolder fs-4"},M={class:"col-6 text-end h-auto"},A=["onClick"],R={key:1,class:"border border-brown rounded p-1 align-items-end mt-1 btn",style:{cursor:"text"}};function S(e,t,a,n,r,o){const i=(0,s.g2)("loading-modal"),d=(0,s.g2)("already-paid"),c=(0,s.g2)("pagination-modal");return(0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.bF)(i,{active:r.isLoading},null,8,["active"]),r.notFound?((0,s.uX)(),(0,s.CE)("div",L,[t[1]||(t[1]=(0,s.eW)(" 唉呀，找不到訂單...",-1)),t[2]||(t[2]=(0,s.Lk)("i",{class:"bi bi-search"},null,-1)),t[3]||(t[3]=(0,s.Lk)("br",null,null,-1)),t[4]||(t[4]=(0,s.Lk)("br",null,null,-1)),t[5]||(t[5]=(0,s.eW)(" 請重新搜尋或",-1)),t[6]||(t[6]=(0,s.Lk)("br",null,null,-1)),t[7]||(t[7]=(0,s.Lk)("br",null,null,-1)),(0,s.Lk)("button",{type:"button",class:"btn btn-outline-brown btn-lg",onClick:t[0]||(t[0]=(...e)=>o.getOrderAll&&o.getOrderAll(...e))},"回到全部訂單"),t[8]||(t[8]=(0,s.Lk)("br",null,null,-1))])):r.connectError?((0,s.uX)(),(0,s.CE)("div",b,[...t[9]||(t[9]=[(0,s.eW)(" 連線錯誤，請重新整理後再搜一次...",-1),(0,s.Lk)("i",{class:"bi bi-wifi-off"},null,-1)])])):((0,s.uX)(!0),(0,s.CE)(s.FK,{key:2},(0,s.pI)(r.searchResult,(a,n)=>((0,s.uX)(),(0,s.CE)("div",{key:n,class:"pb-4"},[(0,s.Lk)("div",m,[(0,s.Lk)("div",{class:"card-header",onClick:e=>o.boxToggle(n)},[(0,s.Lk)("div",v,[(0,s.Lk)("div",y,[(0,s.Lk)("div",w,[t[10]||(t[10]=(0,s.eW)(" 訂單編號：",-1)),t[11]||(t[11]=(0,s.Lk)("br",null,null,-1)),(0,s.eW)((0,g.v_)(a.id),1)]),(0,s.Lk)("div",C,[t[12]||(t[12]=(0,s.eW)(" 下單日期：",-1)),t[13]||(t[13]=(0,s.Lk)("br",null,null,-1)),(0,s.eW)((0,g.v_)(e.$num.date(a.create_at)),1)]),(0,s.Lk)("div",{class:"col-12 text-center",ref_for:!0,ref:"arrowDown",style:{transform:"rotate(0deg)",transition:"1s ease"}},[...t[14]||(t[14]=[(0,s.Lk)("i",{class:"bi bi-caret-down-fill"},null,-1)])],512)])])],8,f),(0,s.Lk)("div",{class:"card-body boxClose",ref_for:!0,ref:"cards",style:{"max-height":"0",padding:"0"}},[(0,s.Lk)("table",x,[(0,s.Lk)("tbody",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(a.products,(e,t)=>((0,s.uX)(),(0,s.CE)("tr",{key:t},[(0,s.Lk)("td",null,[(0,s.Lk)("div",P,[(0,s.Lk)("img",{class:"img-fluid",src:e.product.imageUrl,alt:""},null,8,$)])]),(0,s.Lk)("td",null,(0,g.v_)(e.product.title),1),(0,s.Lk)("td",null,"數量："+(0,g.v_)(e.qty),1),(0,s.Lk)("td",null,"金額："+(0,g.v_)(e.total),1)]))),128))])]),(0,s.Lk)("table",_,[(0,s.Lk)("tbody",null,[(0,s.Lk)("tr",null,[t[15]||(t[15]=(0,s.Lk)("td",null,"姓名：",-1)),(0,s.Lk)("td",null,(0,g.v_)(a.user.name),1)]),(0,s.Lk)("tr",null,[t[16]||(t[16]=(0,s.Lk)("td",null,"Email：",-1)),(0,s.Lk)("td",null,(0,g.v_)(a.user.email),1)]),(0,s.Lk)("tr",null,[t[17]||(t[17]=(0,s.Lk)("td",null,"電話：",-1)),(0,s.Lk)("td",null,(0,g.v_)(a.user.tel),1)]),(0,s.Lk)("tr",null,[t[18]||(t[18]=(0,s.Lk)("td",null,"地址：",-1)),(0,s.Lk)("td",null,(0,g.v_)(a.user.address),1)]),(0,s.Lk)("tr",null,[t[19]||(t[19]=(0,s.Lk)("td",null,"留言：",-1)),(0,s.Lk)("td",null,(0,g.v_)(a.message),1)])])])],512),(0,s.Lk)("div",E,[(0,s.Lk)("div",I,[(0,s.Lk)("div",X,[(0,s.Lk)("div",O,[(0,s.Lk)("p",F,"總金額："+(0,g.v_)(e.$num.currency(a.total)),1)]),(0,s.Lk)("div",M,[!1===a.is_paid?((0,s.uX)(),(0,s.CE)("a",{key:0,href:"#",class:"btn btn-brown",onClick:(0,l.D$)(e=>o.openPaidModal(a.id,n),["prevent"])},"通知已付款",8,A)):((0,s.uX)(),(0,s.CE)("span",R,[t[20]||(t[20]=(0,s.Lk)("i",{class:"bi bi-check-lg"},null,-1)),(0,s.eW)("已於"+(0,g.v_)(e.$num.date(a.paid_date))+"通知付款",1)]))])])])])])]))),128)),(0,s.bF)(d,{ref:"paidModal",sendPayInfo:r.tempPay,onEmitPay:o.alreadyPaid},null,8,["sendPayInfo","onEmitPay"]),r.pageShow?((0,s.uX)(),(0,s.Wv)(c,{key:3,pages:r.pagination,onEmitPage:o.getOrderAll},null,8,["pages","onEmitPage"])):(0,s.Q3)("",!0)],64)}a(4114);const W={class:"modal fade",id:"delModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},D={class:"modal-dialog",role:"document"},q={class:"modal-content border-0"},K={class:"modal-footer"};function N(e,t,a,l,n,r){return(0,s.uX)(),(0,s.CE)("div",W,[(0,s.Lk)("div",D,[(0,s.Lk)("div",q,[t[2]||(t[2]=(0,s.Lk)("div",{class:"modal-header bg-brown text-white"},[(0,s.Lk)("h5",{class:"modal-title"},[(0,s.Lk)("span",null,"通知付款")]),(0,s.Lk)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t[3]||(t[3]=(0,s.Lk)("div",{class:"modal-body"},"確定要通知已付款嗎？",-1)),(0,s.Lk)("div",K,[t[1]||(t[1]=(0,s.Lk)("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"},"取消 ",-1)),(0,s.Lk)("button",{type:"button",class:"btn btn-brown",onClick:t[0]||(t[0]=t=>e.$emit("emit-pay",n.tempPay))},"確定")])])])],512)}var H=a(3286),T={name:"PayModal",data(){return{tempPay:{}}},props:["sendPayInfo"],emits:["emit-pay"],watch:{sendPayInfo(e,t){console.log(e),this.tempPay={...e}}},mixins:[H.A]},j=a(1241);const z=(0,j.A)(T,[["render",N]]);var U=z,G=a(8589),J={name:"orderShow",data(){return{searchResult:[],pagination:{},afterSearch:!0,notFound:!1,pageShow:!0,connectError:!1,isLoading:!1,num:0,tempPay:{}}},components:{AlreadyPaid:U,PaginationModal:G.A},props:["sendOrder"],watch:{sendOrder(e,t){!0===this.afterSearch&&(this.afterSearch=!1),""===e?this.getOrderAll():this.getOrder(e)}},methods:{getOrder(e){this.isLoading=!0,this.pageShow=!1,this.searchResult=[],this.notFound=!1,this.connectError=!1;const t=`https://vue3-course-api.hexschool.io/api/caffeineshop/order/${e}`;this.$http.get(t).then(e=>{this.isLoading=!1,null!==e.data.order?this.searchResult.push(e.data.order):this.notFound=!0}).catch(()=>{this.isLoading=!1,this.notFound=!0})},getOrderAll(e=1){this.pageShow=!0,this.isLoading=!0,!0===this.notFound&&(this.notFound=!1);const t=`https://vue3-course-api.hexschool.io/api/caffeineshop/orders?page=${e}`;this.$http.get(t).then(e=>{console.log(e),this.isLoading=!1,e.data.success&&(this.searchResult=e.data.orders,this.pagination=e.data.pagination)}).catch(e=>{this.isLoading=!1,this.$InformMessage(e,"取得訂單列表")})},boxToggle(e){"0px"===this.$refs.cards[e].style.maxHeight?(this.$refs.cards[e].style.maxHeight="500px",this.$refs.arrowDown[e].style.transform="rotate(180deg)"):(this.$refs.cards[e].style.maxHeight="0",this.$refs.arrowDown[e].style.transform="rotate(0deg)")},openPaidModal(e,t){this.tempPay={tempId:e,tempNum:t},this.$refs.paidModal.showModal()},alreadyPaid(e){this.$refs.paidModal.hideModal(),this.isLoading=!0;const t=`https://vue3-course-api.hexschool.io/api/caffeineshop/pay/${e.tempId}`;this.$http.post(t).then(t=>{this.isLoading=!1,this.searchResult[e.tempNum].is_paid=!0;const a=new Date;this.searchResult[e.tempNum].paid_date=Math.floor(a/1e3),this.tempPay={}}).catch(e=>{this.$InformMessage(e,"通知付款")})}},created(){this.$route.query.orderId||this.getOrderAll()}};const Q=(0,j.A)(J,[["render",S]]);var V=Q,B={name:"OrderRecord",data(){return{searchId:"",searchResult:""}},components:{orderShow:V},methods:{searchOrder(){""!==this.searchId?(this.searchResult=this.searchId,this.searchId=""):alert("輸入欄不能是空的！")},resetSearch(){this.searchResult=""}},mounted(){this.$route.query.orderId&&(this.searchResult=this.$route.query.orderId)}};const Y=(0,j.A)(B,[["render",k]]);var Z=Y},8589:function(e,t,a){a.d(t,{A:function(){return v}});var s=a(6768),l=a(5130),n=a(4232);const r={class:"container"},o={class:"row"},i={class:"col-12"},d={"aria-label":"Page navigation example"},c={class:"pagination justify-content-center"},u={key:0,class:"page-item"},h={key:1,class:"page-item disabled"},p=["onClick"],k={key:2,class:"page-item"},g={key:3,class:"page-item disabled"};function L(e,t,a,L,b,m){return(0,s.uX)(),(0,s.CE)("div",r,[(0,s.Lk)("div",o,[(0,s.Lk)("div",i,[(0,s.Lk)("nav",d,[(0,s.Lk)("ul",c,[a.pages.has_pre?((0,s.uX)(),(0,s.CE)("li",u,[(0,s.Lk)("a",{class:"page-link",href:"#","aria-label":"Previous",onClick:t[0]||(t[0]=(0,l.D$)(e=>m.updatePage(a.pages.current_page-1),["prevent"]))},[...t[2]||(t[2]=[(0,s.Lk)("span",{"aria-hidden":"true"},"«",-1)])])])):((0,s.uX)(),(0,s.CE)("li",h,[...t[3]||(t[3]=[(0,s.Lk)("span",{class:"page-link","aria-hidden":"true"},"«",-1)])])),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(a.pages.total_pages,e=>((0,s.uX)(),(0,s.CE)("li",{class:(0,n.C4)(["page-item",{active:e===a.pages.current_page}]),key:e},[(0,s.Lk)("a",{class:"page-link",href:"#",onClick:(0,l.D$)(t=>m.updatePage(e),["prevent"])},(0,n.v_)(e),9,p)],2))),128)),a.pages.has_next?((0,s.uX)(),(0,s.CE)("li",k,[(0,s.Lk)("a",{class:"page-link",href:"#","aria-label":"Next",onClick:t[1]||(t[1]=(0,l.D$)(e=>m.updatePage(a.pages.current_page+1),["prevent"]))},[...t[4]||(t[4]=[(0,s.Lk)("span",{"aria-hidden":"true"},"»",-1)])])])):((0,s.uX)(),(0,s.CE)("li",g,[...t[5]||(t[5]=[(0,s.Lk)("span",{class:"page-link","aria-hidden":"true"},"»",-1)])]))])])])])])}var b={name:"PaginationModal",props:["pages"],methods:{updatePage(e){window.scrollTo({top:0}),this.$emit("emit-page",e)}}},m=a(1241);const f=(0,m.A)(b,[["render",L]]);var v=f}}]);
//# sourceMappingURL=988.954808aa.js.map