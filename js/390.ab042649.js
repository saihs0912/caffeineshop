"use strict";(self["webpackChunkcaffeineshop"]=self["webpackChunkcaffeineshop"]||[]).push([[390],{1814:function(t,e,s){s.d(e,{A:function(){return v}});var a=s(6768),o=s(5130),i=s(4232);const n={class:"container"},r={class:"row"},c={class:"col-12"},h={"aria-label":"Page navigation example"},d={class:"pagination justify-content-center"},l={key:0,class:"page-item"},u={key:1,class:"page-item disabled"},p=["onClick"],f={key:2,class:"page-item"},g={key:3,class:"page-item disabled"};function m(t,e,s,m,k,$){return(0,a.uX)(),(0,a.CE)("div",n,[(0,a.Lk)("div",r,[(0,a.Lk)("div",c,[(0,a.Lk)("nav",h,[(0,a.Lk)("ul",d,[s.pages.has_pre?((0,a.uX)(),(0,a.CE)("li",l,[(0,a.Lk)("a",{class:"page-link",href:"#","aria-label":"Previous",onClick:e[0]||(e[0]=(0,o.D$)(t=>$.updatePage(s.pages.current_page-1),["prevent"]))},[...e[2]||(e[2]=[(0,a.Lk)("span",{"aria-hidden":"true"},"«",-1)])])])):((0,a.uX)(),(0,a.CE)("li",u,[...e[3]||(e[3]=[(0,a.Lk)("span",{class:"page-link","aria-hidden":"true"},"«",-1)])])),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(s.pages.total_pages,t=>((0,a.uX)(),(0,a.CE)("li",{class:(0,i.C4)(["page-item",{active:t===s.pages.current_page}]),key:t},[(0,a.Lk)("a",{class:"page-link",href:"#",onClick:(0,o.D$)(e=>$.updatePage(t),["prevent"])},(0,i.v_)(t),9,p)],2))),128)),s.pages.has_next?((0,a.uX)(),(0,a.CE)("li",f,[(0,a.Lk)("a",{class:"page-link",href:"#","aria-label":"Next",onClick:e[1]||(e[1]=(0,o.D$)(t=>$.updatePage(s.pages.current_page+1),["prevent"]))},[...e[4]||(e[4]=[(0,a.Lk)("span",{"aria-hidden":"true"},"»",-1)])])])):((0,a.uX)(),(0,a.CE)("li",g,[...e[5]||(e[5]=[(0,a.Lk)("span",{class:"page-link","aria-hidden":"true"},"»",-1)])]))])])])])])}var k={name:"PaginationModal",props:["pages"],methods:{updatePage(t){window.scrollTo({top:0}),this.$emit("emit-page",t)}}},$=s(1241);const y=(0,$.A)(k,[["render",m]]);var v=y},5306:function(t,e,s){s.d(e,{AS:function(){return o},Ap:function(){return b},FD:function(){return h},GW:function(){return p},Jj:function(){return d},Jv:function(){return g},QM:function(){return $},Xl:function(){return n},_t:function(){return x},b$:function(){return f},bE:function(){return r},c5:function(){return y},c8:function(){return L},e0:function(){return m},fS:function(){return l},iH:function(){return c},iY:function(){return I},k3:function(){return k},mx:function(){return v},n7:function(){return w},oo:function(){return i},r$:function(){return u}});s(4114),s(8111),s(7588);var a=s(1600);async function o(t){const e="https://vue3-course-api.hexschool.io/api/caffeineshop/products/all";try{const s=await t.get(e);return s.data.products}catch(s){const t=new Error("取得產品列表");t.original=t}}async function i(t,e){try{const s=`https://vue3-course-api.hexschool.io/api/caffeineshop/product/${e}`,a=await t.get(s);return a}catch(s){throw new Error("無法取得商品")}}async function n(t){const e="https://vue3-course-api.hexschool.io/api/caffeineshop/cart";try{const s=await this.$http.get(e),a=s.data.data;if(this.cart=a,this.cart.carts[0]?.coupon?.code&&(this.usedCoupon=this.cart.carts[0].coupon.code),this.num=a.carts.length,"check"===t)this.$emit("sendCart",this.cart);else if("cart"===t)return this.$emit("updateNum",this.num),this.cart.carts.length}catch(s){console.log(s),this.$InformMessage(s,"取得購物車資訊"),"cart"===t&&(this.err=!0)}}async function r(t,e,s,o,i){const n="https://vue3-course-api.hexschool.io/api/caffeineshop/cart";"detail"===o&&this.cartPutIn&&(this.cartPutIn=!this.cartPutIn),"list"===o&&(this.status.loadingItem=e);const r={product_id:e,qty:s};try{const e=await t.post(n,{data:r});if(console.log(e),"list"===o?this.cart=i:"detail"===o&&(this.cartPutIn=!0),"follow"!==o&&"cart"!==o)this.status.loadingItem="",this.$InformMessage(e,"商品放入購物車");else if("follow"===o||"cart"===o)return e;a.A.emit("updateCart")}catch(c){if("follow"!==o)this.status.loadingItem="",this.$InformMessage(c,"商品放入購物車");else if("follow"===o){const t=new Error("商品放入購物車");throw t.original=t,t}}}async function c(t,e){try{this.status.loadingItem=t.id;const s=`https://vue3-course-api.hexschool.io/api/caffeineshop/cart/${t.id}`,a={product_id:t.product_id,qty:t.qty};await this.$http.put(s,{data:a}),this.status.loadingItem="",this.getCart(e)}catch(s){this.status.loadingItem="",this.$InformMessage(s,"購物車更新")}}async function h(t,e){try{this.status.loadingItem=t;const s=`https://vue3-course-api.hexschool.io/api/caffeineshop/cart/${t}`;await this.$http.delete(s,{data:t}),this.status.loadingItem="",this.getCart(e)}catch(s){this.status.loadingItem="",this.$InformMessage(s,"商品刪除")}}async function d(t,e){try{const s="https://vue3-course-api.hexschool.io/api/caffeineshop/coupon",a={code:t},o=await e.post(s,{data:a});return o}catch(s){throw new Error(s)}}async function l(){const t="https://vue3-course-api.hexschool.io/api/caffeineshop/order",e=this.form;try{const s=await this.$http.post(t,{data:e});this.orderId=s.data.orderId}catch(s){this.$InformMessage(s,"送出訂單")}}async function u(t,e){this.isLoading=!0,"orderlist"===e&&(this.pageShow=!1,this.searchResult=[],this.notFound=!1,this.connectError=!1);const s=`https://vue3-course-api.hexschool.io/api/caffeineshop/order/${t}`;try{const t=await this.$http.get(s);this.isLoading=!1,"orderlist"===e?null!==t.data.order?this.searchResult.push(t.data.order):this.notFound=!0:"orderdetail"===e&&(this.order=t.data.order,this.user=t.data.order.user,Object.values(this.order.products).forEach((t,e)=>{this.total+=t.total}))}catch(a){this.isLoading=!1,this.notFound=!0}}async function p(t=1){this.pageShow=!0,this.isLoading=!0,!0===this.notFound&&(this.notFound=!1);const e=`https://vue3-course-api.hexschool.io/api/caffeineshop/orders?page=${t}`;try{const t=await this.$http.get(e);this.isLoading=!1,t.data.success&&(this.searchResult=t.data.orders,this.pagination=t.data.pagination)}catch(s){this.isLoading=!1,this.$InformMessage(s,"取得訂單列表")}}async function f(t,e){const s=`https://vue3-course-api.hexschool.io/api/caffeineshop/pay/${t}`;try{await e.post(s)}catch(a){throw new Error(a,"付款")}}async function g(){const t="https://vue3-course-api.hexschool.io/admin/signin";try{const e=await this.$http.post(t,this.user);if(e.data.success){const{token:t,expired:s}=e.data;this.$InformMessage(e,"登入"),document.cookie=`makotoToken=${t}; expires=${s}`,setTimeout(()=>{this.$router.push("/dashboard/productlist")},3e3)}}catch(e){this.$InformMessage(e,"登入")}}async function m(t=1){const e=`https://vue3-course-api.hexschool.io/api/caffeineshop/admin/products/?page=${t}`;this.isLoading=!0;try{const t=await this.$http.get(e);this.isLoading=!1,t.data.success&&(this.products=t.data.products,this.pagination=t.data.pagination)}catch(s){this.$InformMessage(s,"取得頁面資訊")}}async function k(t){this.tempProduct=t;let e="https://vue3-course-api.hexschool.io/api/caffeineshop/admin/product",s="post";this.isNew||(e=`${e}/${t.id}`,s="put");try{const t=await this.$http[s](e,{data:this.tempProduct});t.data.success&&("post"===s?this.$InformMessage(t,"商品新增"):this.$InformMessage(t,"商品更新"),this.getProducts(this.pagination.current_page)),this.$refs.productModal.hideModal()}catch(a){this.$InformMessage(a,"商品更新")}}async function $(t){try{const e=this.$refs[t].files[0],s=new FormData;s.append("file-to-upload",e);const a="https://vue3-course-api.hexschool.io/api/caffeineshop/admin/upload",o=await this.$http.post(a,s);o.data.success&&("fileInput"===t?this.tempProduct.imageUrl=o.data.imageUrl:this.tempProduct.imagesUrl.push(o.data.imageUrl))}catch(e){this.$InformMessage(e,"圖片上傳")}}async function y(t){this.tempProduct=t;const e=`https://vue3-course-api.hexschool.io/api/caffeineshop/admin/product/${t.id}`;try{const s=await this.$http.delete(e,{data:this.tempProduct});this.$InformMessage(s,`商品${t.title}刪除`),this.getProducts()}catch(s){this.$InformMessage(s,"商品刪除")}this.$refs.delModal.hideModal()}async function v(t=1){try{this.isLoading=!0;const e=`https://vue3-course-api.hexschool.io/api/caffeineshop/admin/coupons?page=${t}`,s=await this.$http.get(e);console.log(s),this.coupons=s.data.coupons,this.pagination=s.data.pagination,this.isLoading=!1}catch(e){this.isLoading=!1,this.$InformMessage(e,"取得優惠券列表")}}async function L(t){try{this.tempCoupon=t;let e="https://vue3-course-api.hexschool.io/api/caffeineshop/admin/coupon",s="post";this.isNew||(e=`${e}/${t.id}`,s="put");const a=await this.$http[s](e,{data:this.tempCoupon});"post"===s?this.$InformMessage(a,"優惠券新增"):this.$InformMessage(a,"優惠券更新"),this.$refs.couponModal.hideModal(),this.getCoupons(this.pagination.current_page)}catch(e){this.$refs.couponModal.hideModal(),this.$InformMessage(e,"更新優惠券")}}async function b(t){try{this.tempCoupon=t;const e=`https://vue3-course-api.hexschool.io/api/caffeineshop/admin/coupon/${this.tempCoupon.id}`,s=await this.$http.delete(e,{data:this.tempCoupon});this.$InformMessage(s,`優惠券${t.title}刪除`),this.$refs.delModal.hideModal(),this.getCoupons()}catch(e){this.$refs.delModal.hideModal(),this.$InformMessage(e,"優惠券刪除")}}async function w(t=1){const e=`https://vue3-course-api.hexschool.io/api/caffeineshop/admin/orders?page=${t}`;this.isLoading=!0;try{const t=await this.$http.get(e);this.isLoading=!1,this.orderList=t.data.orders,this.pagination=t.data.pagination}catch(s){this.$InformMessage(s,"取得訂單列表")}}async function I(t){this.tempOrder=t;const e=`https://vue3-course-api.hexschool.io/api/caffeineshop/admin/order/${this.tempOrder.id}`;try{await this.$http.put(e,{data:this.tempOrder}),this.$refs.orderModal.hideModal(),this.num=0,this.getOrderList(this.pagination.current_page)}catch(s){this.$InformMessage(s,"訂單更新")}}async function x(t){this.tempOrder=t;const e=`https://vue3-course-api.hexschool.io/api/caffeineshop/admin/order/${this.tempOrder.id}`;try{const t=await this.$http.delete(e,{data:this.tempOrder});this.$InformMessage(t,"訂單刪除"),this.$refs.delModal.hideModal(),this.getOrderList()}catch(s){this.$InformMessage(s,"訂單刪除")}}},7390:function(t,e,s){s.r(e),s.d(e,{default:function(){return z}});var a=s(6768),o=s(5130);const i={class:"container"},n={class:"row"},r={class:"col-12"},c={class:"mt-4 mb-4"},h={class:"container"},d={class:"row justify-content-center"},l={class:"col-lg-9 col-md-10 col-sm-12 col-12 mt-3 mb-3"},u={class:"input-group h-100"},p={class:"col-lg-9 col-md-10 col-sm-12 col-12 pt-3 pb-5"};function f(t,e,s,f,g,m){const k=(0,a.g2)("router-link"),$=(0,a.g2)("order-show");return(0,a.uX)(),(0,a.CE)("div",i,[(0,a.Lk)("div",n,[(0,a.Lk)("div",r,[(0,a.Lk)("div",c,[(0,a.bF)(k,{to:"/",style:{"text-decoration":"none"}},{default:(0,a.k6)(()=>[...e[2]||(e[2]=[(0,a.eW)("首頁",-1)])]),_:1}),e[3]||(e[3]=(0,a.eW)(" > ",-1)),e[4]||(e[4]=(0,a.Lk)("span",null,"訂單查詢",-1))]),e[5]||(e[5]=(0,a.Lk)("h1",null,"訂單查詢",-1)),(0,a.Lk)("div",h,[(0,a.Lk)("div",d,[(0,a.Lk)("div",l,[(0,a.Lk)("div",u,[(0,a.Lk)("button",{class:"btn btn-outline-secondary",type:"button",id:"button-addon1",onClick:e[0]||(e[0]=(...t)=>m.searchOrder&&m.searchOrder(...t))}," 搜尋 "),(0,a.bo)((0,a.Lk)("input",{type:"search",class:"form-control","aria-label":"Sizing example input","aria-describedby":"inputGroup-sizing-default","onUpdate:modelValue":e[1]||(e[1]=t=>g.searchId=t),placeholder:"輸入訂單編號"},null,512),[[o.Jo,g.searchId]])])]),(0,a.Lk)("div",p,[(0,a.bF)($,{sendOrder:g.searchResult},null,8,["sendOrder"])])])])])])])}var g=s(4232);const m={key:0,class:"text-center fw-bold fs-3 pt-4 pb-4"},k={key:1,class:"text-center fw-bold fs-3 pt-4 pb-4"},$={class:"card"},y={class:"card-header"},v={class:"container"},L={class:"row"},b={class:"col-lg-9 col-md-8 col-sm-8 col-12 py-1 px-0"},w={class:"col-lg-3 col-md-4 col-sm-4 col-12 py-1 px-0 d-flex flex-lg-row-reverse flex-md-row-reverse flex-sm-row-reverse"},I={class:"btn-group"},x=["onClick"],M={class:"table"},C={class:"float-lg-none float-md-none float-sm-none float-start td-img",style:{width:"50px"}},E=["src","alt"],O={class:"td-block"},_={class:"card-footer"},P={class:"container"},X={class:"row"},F={class:"col-6"},A={class:"card-text fw-bolder fs-4"},S={class:"col-6 text-end h-auto d-flex align-items-center justify-content-end"},R={key:0,class:"border border-brown rounded p-1 align-items-end mt-1 btn",style:{cursor:"text"}},W={key:1,class:"border border-brown rounded p-1 align-items-end mt-1 btn",style:{cursor:"text"}};function D(t,e,s,o,i,n){const r=(0,a.g2)("loading-modal"),c=(0,a.g2)("router-link"),h=(0,a.g2)("pagination-modal");return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.bF)(r,{active:i.isLoading},null,8,["active"]),i.notFound?((0,a.uX)(),(0,a.CE)("div",m,[e[1]||(e[1]=(0,a.eW)(" 唉呀，找不到訂單...",-1)),e[2]||(e[2]=(0,a.Lk)("i",{class:"bi bi-search"},null,-1)),e[3]||(e[3]=(0,a.Lk)("br",null,null,-1)),e[4]||(e[4]=(0,a.Lk)("br",null,null,-1)),e[5]||(e[5]=(0,a.eW)(" 請重新搜尋或",-1)),e[6]||(e[6]=(0,a.Lk)("br",null,null,-1)),e[7]||(e[7]=(0,a.Lk)("br",null,null,-1)),(0,a.Lk)("button",{type:"button",class:"btn btn-outline-brown btn-lg",onClick:e[0]||(e[0]=(...t)=>n.getOrderAll&&n.getOrderAll(...t))}," 回到全部訂單 "),e[8]||(e[8]=(0,a.Lk)("br",null,null,-1))])):i.connectError?((0,a.uX)(),(0,a.CE)("div",k,[...e[9]||(e[9]=[(0,a.eW)(" 連線錯誤，請重新整理後再搜一次...",-1),(0,a.Lk)("i",{class:"bi bi-wifi-off"},null,-1)])])):((0,a.uX)(!0),(0,a.CE)(a.FK,{key:2},(0,a.pI)(i.searchResult,(s,o)=>((0,a.uX)(),(0,a.CE)("div",{key:o,class:"pb-4"},[(0,a.Lk)("div",$,[(0,a.Lk)("div",y,[(0,a.Lk)("div",v,[(0,a.Lk)("div",L,[(0,a.Lk)("div",b,[(0,a.Lk)("span",null,"訂購日期："+(0,g.v_)(t.$num.date(s.create_at)),1),e[10]||(e[10]=(0,a.Lk)("br",null,null,-1)),(0,a.Lk)("span",null,"訂單編號："+(0,g.v_)(s.id),1)]),(0,a.Lk)("div",w,[(0,a.Lk)("div",I,[(0,a.Lk)("button",{class:"btn btn-brown",onClick:t=>n.goToDetail(s.id)},[...e[11]||(e[11]=[(0,a.Lk)("i",{class:"bi bi-receipt"},null,-1),(0,a.eW)(" 訂單明細 ",-1)])],8,x)])])])])]),(0,a.Lk)("div",{class:"card-body boxClose",ref_for:!0,ref:"cards"},[(0,a.Lk)("table",M,[(0,a.Lk)("tbody",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(s.products,(t,e)=>((0,a.uX)(),(0,a.CE)("tr",{key:e,class:"tr-border"},[(0,a.Lk)("td",C,[(0,a.Lk)("img",{class:"img-fluid",src:t.product.imageUrl,alt:t.product.title},null,8,E)]),(0,a.Lk)("td",O,[(0,a.bF)(c,{class:"no-underline d-block h-100",to:{name:"product",params:{productId:t.product.id}}},{default:(0,a.k6)(()=>[(0,a.eW)((0,g.v_)(t.product.title),1)]),_:2},1032,["to"])])]))),128))])])],512),(0,a.Lk)("div",_,[(0,a.Lk)("div",P,[(0,a.Lk)("div",X,[(0,a.Lk)("div",F,[(0,a.Lk)("p",A,"總金額："+(0,g.v_)(t.$num.currency(s.total)),1)]),(0,a.Lk)("div",S,[!1===s.is_paid?((0,a.uX)(),(0,a.CE)("span",R,"尚未付款")):((0,a.uX)(),(0,a.CE)("span",W,(0,g.v_)(t.$num.date(s.paid_date))+"已付款",1))])])])])])]))),128)),i.pageShow?((0,a.uX)(),(0,a.Wv)(h,{key:3,pages:i.pagination,onEmitPage:n.getOrderAll},null,8,["pages","onEmitPage"])):(0,a.Q3)("",!0)],64)}s(4114);var q=s(5306),U=s(1814),j={name:"OrderShow",data(){return{searchResult:[],pagination:{},afterSearch:!0,notFound:!1,pageShow:!0,connectError:!1,isLoading:!1,num:0,tempPay:{}}},components:{PaginationModal:U.A},props:["sendOrder"],watch:{sendOrder(t,e){!0===this.afterSearch&&(this.afterSearch=!1),""===t?this.getOrderAll():this.getOrder(t,"orderlist")}},methods:{getOrder:q.r$,getOrderAll:q.GW,goToDetail(t){this.$router.push({name:"orderDetail",params:{orderId:t}})}},created(){this.$route.query.orderId||this.getOrderAll()}},T=s(1241);const K=(0,T.A)(j,[["render",D]]);var N=K,G={name:"OrderRecord",head(){return{title:"訂單查詢 - 咖啡因商店",meta:[{name:"description",content:"一間販賣咖啡因商品的網路店鋪"},{name:"keywords",content:"咖啡因商店,咖啡豆,濾掛式咖啡,茶葉,茶包,甜點"},{property:"og:title",content:"咖啡因商店"},{property:"og:image",content:"../../assets/logo/logo.png"},{property:"og:description",content:"一間販賣咖啡因商品的網路店鋪"}]}},data(){return{searchId:"",searchResult:""}},components:{OrderShow:N},methods:{searchOrder(){""!==this.searchId?this.searchResult=this.searchId:alert("輸入欄不能是空的！")},resetSearch(){this.searchResult=""}},watch:{searchId(t,e){""===t&&(this.searchResult="")}},mounted(){this.$route.query.orderId&&(this.searchResult=this.$route.query.orderId)}};const J=(0,T.A)(G,[["render",f]]);var z=J}}]);
//# sourceMappingURL=390.ab042649.js.map